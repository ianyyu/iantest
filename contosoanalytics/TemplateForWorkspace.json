{
	"$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
	"contentVersion": "1.0.0.0",
	"parameters": {
		"workspaceName": {
			"type": "string",
			"metadata": "Workspace name",
			"defaultValue": "contosoanalytics"
		},
		"AzureDataLakeStorage1_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'AzureDataLakeStorage1'"
		},
		"CosmosDBLink_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'CosmosDBLink'"
		},
		"Source Datasets Josh_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'Source Datasets Josh'"
		},
		"Tutorial_Synapse_accountKey": {
			"type": "secureString",
			"metadata": "Secure string for 'accountKey' of 'Tutorial_Synapse'"
		},
		"contosoanalytics-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'contosoanalytics-WorkspaceDefaultSqlServer'"
		},
		"dangitbugbash-WorkspaceDefaultSqlServer_connectionString": {
			"type": "secureString",
			"metadata": "Secure string for 'connectionString' of 'dangitbugbash-WorkspaceDefaultSqlServer'"
		},
		"AzureDataLakeStorage1_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://agbugbash20200507storage.dfs.core.windows.net"
		},
		"Source Datasets Josh_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://jocaplansynapse.dfs.core.windows.net/"
		},
		"Source Datasets_sasUri": {
			"type": "secureString",
			"metadata": "Secure string for 'sasUri' of 'Source Datasets'"
		},
		"Tutorial_Synapse_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://contosolake.dfs.core.windows.net"
		},
		"bing-covid-19-data_sasUri": {
			"type": "secureString",
			"metadata": "Secure string for 'sasUri' of 'bing-covid-19-data'"
		},
		"contosoanalytics-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://contosolake.dfs.core.windows.net"
		},
		"covid-tracking_sasUri": {
			"type": "secureString",
			"metadata": "Secure string for 'sasUri' of 'covid-tracking'"
		},
		"dangitbugbash-WorkspaceDefaultStorage_properties_typeProperties_url": {
			"type": "string",
			"defaultValue": "https://dansynapsestroage.dfs.core.windows.net"
		}
	},
	"variables": {
		"workspaceId": "[concat('Microsoft.Synapse/workspaces/', parameters('workspaceName'))]"
	},
	"resources": [
		{
			"name": "[concat(parameters('workspaceName'), '/contosoedw')]",
			"type": "Microsoft.Synapse/workspaces/sqlPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/contososqlpool')]",
			"type": "Microsoft.Synapse/workspaces/sqlPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/contosowdw')]",
			"type": "Microsoft.Synapse/workspaces/sqlPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQLDB1')]",
			"type": "Microsoft.Synapse/workspaces/sqlPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Test')]",
			"type": "Microsoft.Synapse/workspaces/sqlPools",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CopyGeo')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy_zo0",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "synapsecontainer/Data/NYCTaxiSample/dimGeography.parquet"
							},
							{
								"name": "Destination",
								"value": "datasets/nyctaxismall/"
							}
						],
						"typeProperties": {
							"source": {
								"type": "ParquetSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true
								}
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_zo0",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_zo0",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2020-05-11T18:01:25Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/SourceDataset_zo0')]",
				"[concat(variables('workspaceId'), '/datasets/DestinationDataset_zo0')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CopyPipeline_aje')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy_aje",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "synapsecontainer/Data/NYCTaxiSample/"
							},
							{
								"name": "Destination",
								"value": "datasets/nyctaxismall/"
							}
						],
						"typeProperties": {
							"source": {
								"type": "ParquetSource",
								"storeSettings": {
									"type": "AzureBlobFSReadSettings",
									"recursive": true,
									"wildcardFileName": "*"
								}
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobStorageWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_aje",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_aje",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2020-03-12T04:43:51Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/SourceDataset_aje')]",
				"[concat(variables('workspaceId'), '/datasets/DestinationDataset_aje')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/FirstCopyActivity')]",
			"type": "Microsoft.Synapse/workspaces/pipelines",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"activities": [
					{
						"name": "Copy_5yx",
						"type": "Copy",
						"dependsOn": [],
						"policy": {
							"timeout": "7.00:00:00",
							"retry": 0,
							"retryIntervalInSeconds": 30,
							"secureOutput": false,
							"secureInput": false
						},
						"userProperties": [
							{
								"name": "Source",
								"value": "datasets/NYCTaxiSample/"
							},
							{
								"name": "Destination",
								"value": "datasets/nyctaxismall/"
							}
						],
						"typeProperties": {
							"source": {
								"type": "ParquetSource",
								"storeSettings": {
									"type": "AzureBlobStorageReadSettings",
									"recursive": true,
									"wildcardFileName": "*"
								}
							},
							"sink": {
								"type": "ParquetSink",
								"storeSettings": {
									"type": "AzureBlobFSWriteSettings"
								}
							},
							"enableStaging": false
						},
						"inputs": [
							{
								"referenceName": "SourceDataset_5yx",
								"type": "DatasetReference",
								"parameters": {}
							}
						],
						"outputs": [
							{
								"referenceName": "DestinationDataset_5yx",
								"type": "DatasetReference",
								"parameters": {}
							}
						]
					}
				],
				"annotations": [],
				"lastPublishTime": "2020-03-12T04:54:43Z"
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/datasets/SourceDataset_5yx')]",
				"[concat(variables('workspaceId'), '/datasets/DestinationDataset_5yx')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_05a')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "contosoanalytics-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "nyctaxismall",
						"fileSystem": "datasets"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/contosoanalytics-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_5yx')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Tutorial_Synapse",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "nyctaxismall",
						"fileSystem": "datasets"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Tutorial_Synapse')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_aje')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Source Datasets",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "nyctaxismall",
						"container": "datasets"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Source Datasets')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/DestinationDataset_zo0')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "contosoanalytics-WorkspaceDefaultStorage",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "nyctaxismall",
						"fileSystem": "datasets"
					},
					"compressionCodec": "snappy"
				},
				"schema": []
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/contosoanalytics-WorkspaceDefaultStorage')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SourceDataset_5yx')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Source Datasets",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobStorageLocation",
						"folderPath": "NYCTaxiSample",
						"container": "datasets"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "DateID",
						"type": "INT32"
					},
					{
						"name": "MedallionID",
						"type": "INT32"
					},
					{
						"name": "HackneyLicenseID",
						"type": "INT32"
					},
					{
						"name": "PickupTimeID",
						"type": "INT32"
					},
					{
						"name": "DropoffTimeID",
						"type": "INT32"
					},
					{
						"name": "PickupGeographyID",
						"type": "INT32"
					},
					{
						"name": "DropoffGeographyID",
						"type": "INT32"
					},
					{
						"name": "PickupLatitude",
						"type": "DOUBLE"
					},
					{
						"name": "PickupLongitude",
						"type": "DOUBLE"
					},
					{
						"name": "PickupLatLong",
						"type": "UTF8"
					},
					{
						"name": "DropoffLatitude",
						"type": "DOUBLE"
					},
					{
						"name": "DropoffLongitude",
						"type": "DOUBLE"
					},
					{
						"name": "DropoffLatLong",
						"type": "UTF8"
					},
					{
						"name": "PassengerCount",
						"type": "INT32"
					},
					{
						"name": "TripDurationSeconds",
						"type": "INT32"
					},
					{
						"name": "TripDistanceMiles",
						"type": "DOUBLE"
					},
					{
						"name": "PaymentType",
						"type": "UTF8"
					},
					{
						"name": "FareAmount",
						"type": "DECIMAL",
						"precision": 38,
						"scale": 18
					},
					{
						"name": "SurchargeAmount",
						"type": "DECIMAL",
						"precision": 38,
						"scale": 18
					},
					{
						"name": "TaxAmount",
						"type": "DECIMAL",
						"precision": 38,
						"scale": 18
					},
					{
						"name": "TipAmount",
						"type": "DECIMAL",
						"precision": 38,
						"scale": 18
					},
					{
						"name": "TollsAmount",
						"type": "DECIMAL",
						"precision": 38,
						"scale": 18
					},
					{
						"name": "TotalAmount",
						"type": "DECIMAL",
						"precision": 38,
						"scale": 18
					},
					{
						"name": "IR_DateID",
						"type": "INT32"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Source Datasets')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SourceDataset_aje')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Source Datasets Josh",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"folderPath": "Data/NYCTaxiSample",
						"fileSystem": "synapsecontainer"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "DateID",
						"type": "INT32"
					},
					{
						"name": "MedallionID",
						"type": "INT32"
					},
					{
						"name": "HackneyLicenseID",
						"type": "INT32"
					},
					{
						"name": "PickupTimeID",
						"type": "INT32"
					},
					{
						"name": "DropoffTimeID",
						"type": "INT32"
					},
					{
						"name": "PickupGeographyID",
						"type": "INT32"
					},
					{
						"name": "DropoffGeographyID",
						"type": "INT32"
					},
					{
						"name": "PickupLatitude",
						"type": "DOUBLE"
					},
					{
						"name": "PickupLongitude",
						"type": "DOUBLE"
					},
					{
						"name": "PickupLatLong",
						"type": "UTF8"
					},
					{
						"name": "DropoffLatitude",
						"type": "DOUBLE"
					},
					{
						"name": "DropoffLongitude",
						"type": "DOUBLE"
					},
					{
						"name": "DropoffLatLong",
						"type": "UTF8"
					},
					{
						"name": "PassengerCount",
						"type": "INT32"
					},
					{
						"name": "TripDurationSeconds",
						"type": "INT32"
					},
					{
						"name": "TripDistanceMiles",
						"type": "DOUBLE"
					},
					{
						"name": "PaymentType",
						"type": "UTF8"
					},
					{
						"name": "FareAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "SurchargeAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "TaxAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "TipAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "TollsAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "TotalAmount",
						"type": "DECIMAL",
						"precision": 19,
						"scale": 4
					},
					{
						"name": "IR_DateID",
						"type": "INT32"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Source Datasets Josh')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SourceDataset_zo0')]",
			"type": "Microsoft.Synapse/workspaces/datasets",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"linkedServiceName": {
					"referenceName": "Source Datasets Josh",
					"type": "LinkedServiceReference"
				},
				"annotations": [],
				"type": "Parquet",
				"typeProperties": {
					"location": {
						"type": "AzureBlobFSLocation",
						"fileName": "dimGeography.parquet",
						"folderPath": "Data/NYCTaxiSample",
						"fileSystem": "synapsecontainer"
					},
					"compressionCodec": "snappy"
				},
				"schema": [
					{
						"name": "GeographyID",
						"type": "INT32"
					},
					{
						"name": "ZipCodeBKey",
						"type": "UTF8"
					},
					{
						"name": "County",
						"type": "UTF8"
					},
					{
						"name": "City",
						"type": "UTF8"
					},
					{
						"name": "State",
						"type": "UTF8"
					},
					{
						"name": "Country",
						"type": "UTF8"
					},
					{
						"name": "ZipCode",
						"type": "UTF8"
					}
				]
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/linkedServices/Source Datasets Josh')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AzureDataLakeStorage1')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('AzureDataLakeStorage1_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('AzureDataLakeStorage1_accountKey')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CosmosDBLink')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "CosmosDb",
				"typeProperties": {
					"connectionString": "[parameters('CosmosDBLink_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Source Datasets Josh')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('Source Datasets Josh_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('Source Datasets Josh_accountKey')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Source Datasets')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"sasUri": "[parameters('Source Datasets_sasUri')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Synapse Power BI Reports')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "PowerBIWorkspace",
				"typeProperties": {
					"workspaceID": "78a523b6-1b64-44f9-82bf-a0f13cd852b6"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Tutorial_Synapse')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('Tutorial_Synapse_properties_typeProperties_url')]",
					"accountKey": {
						"type": "SecureString",
						"value": "[parameters('Tutorial_Synapse_accountKey')]"
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/bing-covid-19-data')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"sasUri": "[parameters('bing-covid-19-data_sasUri')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/contosoanalytics-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('contosoanalytics-WorkspaceDefaultSqlServer_connectionString')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/contosoanalytics-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('contosoanalytics-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/covid-tracking')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobStorage",
				"typeProperties": {
					"sasUri": "[parameters('covid-tracking_sasUri')]"
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dangitbugbash-WorkspaceDefaultSqlServer')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"parameters": {
					"DBName": {
						"type": "String"
					}
				},
				"annotations": [],
				"type": "AzureSqlDW",
				"typeProperties": {
					"connectionString": "[parameters('dangitbugbash-WorkspaceDefaultSqlServer_connectionString')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/dangitbugbash-WorkspaceDefaultStorage')]",
			"type": "Microsoft.Synapse/workspaces/linkedServices",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"annotations": [],
				"type": "AzureBlobFS",
				"typeProperties": {
					"url": "[parameters('dangitbugbash-WorkspaceDefaultStorage_properties_typeProperties_url')]"
				},
				"connectVia": {
					"referenceName": "AutoResolveIntegrationRuntime",
					"type": "IntegrationRuntimeReference"
				}
			},
			"dependsOn": [
				"[concat(variables('workspaceId'), '/integrationRuntimes/AutoResolveIntegrationRuntime')]"
			]
		},
		{
			"name": "[concat(parameters('workspaceName'), '/AutoResolveIntegrationRuntime')]",
			"type": "Microsoft.Synapse/workspaces/integrationRuntimes",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "Managed",
				"typeProperties": {
					"computeProperties": {
						"location": "AutoResolve",
						"dataFlowProperties": {
							"computeType": "General",
							"coreCount": 8,
							"timeToLive": 0
						}
					}
				}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/WorkspaceSystemIdentity')]",
			"type": "Microsoft.Synapse/workspaces/credentials",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"type": "ManagedIdentity",
				"typeProperties": {}
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Runtime')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "-- type your sql script here, we now have intellisense",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 1')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "-- type your sql script here, we now have intellisense\n",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 2')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "-- type your sql script here, we now have intellisense\nselect top adfasdf ",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 3')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "-- This is auto-generated code\nSELECT\n    TOP 100 *\nFROM\n    OPENROWSET(\n        BULK     'https://pandemicdatalake.blob.core.windows.net/public/curated/covid-19/bing_covid-19_data/latest/bing_covid-19_data.parquet',\n        FORMAT = 'parquet'\n    ) AS [result];",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/CosmosDBLink')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "contosospark",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {}
				},
				"metadata": {
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/58f8824d-32b0-4825-9825-02fa6a801546/resourceGroups/Contoso/providers/Microsoft.Synapse/workspaces/contosoanalytics/bigDataPools/contosospark",
						"name": "contosospark",
						"type": "Spark",
						"endpoint": "https://contosoanalytics.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/contosospark",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 3,
						"cores": 8,
						"memory": 56
					}
				},
				"cells": [
					{
						"cell_type": "markdown",
						"source": [
							"![Overview](https://labigniteadls02.blob.core.windows.net/pictures/CosmosDB_Synapse.png)"
						]
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Spark demo items\n",
							"\n",
							"* Read into a dataframe from Cosmos DB as a linked service\n",
							"* Create a Spark table pointing to Cosmos DB (unmanaged table)\n",
							"* Do some data transformation (Flatten nested structure, explode arrays)\n",
							"* Write curated data back into Cosmos DB (OLTP store) with Spark\n",
							"\n",
							"**With the latest and simplest connector from Spark**\n",
							"\n",
							"This work spans across Cosmos DB, Spark, ADF, Synapse UX, Synapse Platform through different functions (Dev, Design and PM)"
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [],
									"values": [],
									"yLabel": "",
									"xLabel": "",
									"aggregation": "SUM",
									"aggByBackend": false
								},
								"previewData": {
									"rows": [],
									"schema": [],
									"filter": null
								},
								"isSummary": false,
								"isSql": true
							}
						},
						"source": [
							"%%sql\n",
							"DROP TABLE default.DemoCosmosDB"
						],
						"outputs": [],
						"execution_count": 3
					},
					{
						"cell_type": "code",
						"source": [
							"df_retail_data = spark.read.option(\"spark.cosmos.synapse.linkedServiceName\" , \"CosmosDBLink\")\\\n",
							"        .option(\"spark.cosmos.region\", \"west us 2\")\\\n",
							"        .option(\"spark.cosmos.databaseName\", \"sample-db-001\")\\\n",
							"        .option(\"spark.cosmos.containerName\", \"sample-container-001\")\\\n",
							"        .format(\"cosmos.olap\").load()"
						],
						"outputs": [],
						"execution_count": 4
					},
					{
						"cell_type": "code",
						"metadata": {
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [
										"_rid"
									],
									"values": [
										"_rid"
									],
									"yLabel": "_rid",
									"xLabel": "_rid",
									"aggregation": "COUNT",
									"aggByBackend": false
								},
								"previewData": {
									"rows": [
										{
											"_rid": "o9tdAL4WfHEDAAAAAAAAAA==",
											"_ts": 1582307294,
											"name": "Jillian Schroeder",
											"username": "Maurice_Sawayn",
											"email": "Priscilla_Jones@hotmail.com",
											"address": {
												"streetA": "Baumbach Center",
												"streetB": "441 Shanon Fords",
												"streetC": "41296 Mckenna Cove Apt. 434",
												"streetD": "Apt. 818",
												"city": "Lake Aglaetown",
												"state": "Indiana",
												"country": "Tuvalu",
												"zipcode": "06441",
												"geo": {
													"lat": "-34.7248",
													"lng": "22.1263"
												}
											},
											"phone": "1-928-355-8933",
											"website": "faye.org",
											"company": {
												"name": "Zemlak - Hyatt",
												"catchPhrase": "Adaptive 3rd generation strategy",
												"bs": "scalable exploit partnerships"
											},
											"posts": [
												{
													"words": "et sed omnis",
													"sentence": "Sed nobis odio.",
													"sentences": "Sapiente delectus ipsa quasi optio fuga tempore. At ratione ab provident ut ut dolores vero corporis.",
													"paragraph": "Voluptas pariatur sint dolor ut aliquid molestiae facilis architecto. Nemo ut consequuntur quidem cum omnis. Dolore quae corporis placeat beatae voluptate et in mollitia. Nobis veniam aliquam error. Molestiae eos sapiente."
												},
												{
													"words": "repellendus molestias sed",
													"sentence": "Accusantium accusantium exercitationem.",
													"sentences": "Eius et voluptatem nisi voluptates in unde accusamus qui. Voluptatum voluptatibus ratione veritatis doloremque quo ut. Quia odit et ipsam corrupti ducimus qui eum maiores. Eveniet nesciunt molestiae et molestiae.",
													"paragraph": "Sequi est consequatur est ad magnam quidem. Quisquam ut natus fugiat libero tempore magni quis quas quidem. Aspernatur eligendi et ratione repudiandae sit."
												},
												{
													"words": "sed dolorem sint",
													"sentence": "Sit consectetur magni natus doloribus.",
													"sentences": "Optio debitis fugit facere iusto ex modi aliquam. Illum quod et maxime accusamus laborum natus veritatis.",
													"paragraph": "Autem dolores dolor expedita sapiente ex cum eligendi iusto adipisci. Minus facilis delectus quo. In corporis mollitia molestiae. Vel voluptas optio."
												}
											],
											"accountHistory": [
												{
													"amount": "107.62",
													"date": "2012-02-02T06:00:00Z",
													"business": "Roob LLC",
													"name": "Home Loan Account 6220",
													"type": "payment",
													"account": "03705510"
												},
												{
													"amount": "650.88",
													"date": "2012-02-02T06:00:00Z",
													"business": "Kuphal, Lynch and Pouros",
													"name": "Checking Account 9001",
													"type": "payment",
													"account": "85352791"
												},
												{
													"amount": "878.63",
													"date": "2012-02-02T06:00:00Z",
													"business": "Reynolds Group",
													"name": "Money Market Account 8743",
													"type": "deposit",
													"account": "53230334"
												}
											],
											"id": "f8f1b82c-27ff-4dc2-b51e-854f6867030b",
											"_etag": "\"49009c9d-0000-0100-0000-5e5017de0000\""
										},
										{
											"_rid": "o9tdAL4WfHEFAAAAAAAAAA==",
											"_ts": 1582307294,
											"name": "Lon Steuber",
											"username": "Tiffany.Dibbert",
											"email": "Elliott.Runolfsson@yahoo.com",
											"address": {
												"streetA": "Renner Ridge",
												"streetB": "9414 Peggie Turnpike",
												"streetC": "57322 Johnson Streets Apt. 039",
												"streetD": "Apt. 117",
												"city": "Croninfurt",
												"state": "Nebraska",
												"country": "Mozambique",
												"zipcode": "43537",
												"geo": {
													"lat": "21.8544",
													"lng": "-15.5911"
												}
											},
											"phone": "1-578-998-1626 x882",
											"website": "madalyn.net",
											"company": {
												"name": "Zieme Group",
												"catchPhrase": "Versatile web-enabled ability",
												"bs": "ubiquitous envisioneer action-items"
											},
											"posts": [
												{
													"words": "dignissimos et deleniti",
													"sentence": "Et eligendi id officia voluptatem sint voluptas assumenda eligendi.",
													"sentences": "Eveniet omnis ut ad consequuntur. Asperiores sunt occaecati possimus facilis dolore soluta architecto. Voluptatum enim tempora officia occaecati eius deserunt facilis cumque reprehenderit.",
													"paragraph": "Commodi provident in tenetur quis saepe ducimus corporis cupiditate totam. Ad corrupti culpa in quasi nesciunt nisi velit. Velit repellendus eum qui quo."
												},
												{
													"words": "corrupti rerum voluptate",
													"sentence": "Nobis rerum occaecati rem excepturi vel vel.",
													"sentences": "Voluptatem eos a. Eius nihil voluptatem qui. Minima voluptas sed quasi iusto. Repudiandae repudiandae et hic ipsum aut numquam aspernatur. Atque beatae sed animi facere necessitatibus quod rem. Adipisci sapiente quisquam doloribus provident.",
													"paragraph": "Totam inventore dolor animi omnis. Sequi hic a magni iure temporibus ratione exercitationem quis. Perferendis qui eum quo non voluptatem et eum."
												},
												{
													"words": "distinctio et quis",
													"sentence": "Eum adipisci aut.",
													"sentences": "Modi cupiditate quo doloribus eius libero. Quas sint fuga quod. Accusantium quia quidem. Sapiente ab impedit exercitationem ut error quia. Laudantium ipsam doloremque dolores alias. Quae saepe qui rerum enim.",
													"paragraph": "Molestiae reiciendis repudiandae voluptates quasi in ut. Dolores sequi sapiente. Aperiam sed dolores voluptatibus doloremque voluptatem."
												}
											],
											"accountHistory": [
												{
													"amount": "602.45",
													"date": "2012-02-02T06:00:00Z",
													"business": "Price Inc",
													"name": "Personal Loan Account 9924",
													"type": "deposit",
													"account": "61871935"
												},
												{
													"amount": "377.08",
													"date": "2012-02-02T06:00:00Z",
													"business": "Swaniawski - Barton",
													"name": "Investment Account 1002",
													"type": "withdrawal",
													"account": "24221301"
												},
												{
													"amount": "204.44",
													"date": "2012-02-02T06:00:00Z",
													"business": "Hilpert, Carroll and Kutch",
													"name": "Auto Loan Account 2452",
													"type": "withdrawal",
													"account": "15660473"
												}
											],
											"id": "a429da80-1c6a-464e-98bf-ca1f0dab236a",
											"_etag": "\"49009e9d-0000-0100-0000-5e5017de0000\""
										},
										{
											"_rid": "o9tdAL4WfHEGAAAAAAAAAA==",
											"_ts": 1582307294,
											"name": "Fern Barton",
											"username": "Troy64",
											"email": "Iva.Quigley95@gmail.com",
											"address": {
												"streetA": "Junior Key",
												"streetB": "812 Pamela Corner",
												"streetC": "948 Willms Passage Suite 826",
												"streetD": "Apt. 968",
												"city": "Stoltenbergtown",
												"state": "Louisiana",
												"country": "Central African Republic",
												"zipcode": "42760-7544",
												"geo": {
													"lat": "-67.1468",
													"lng": "-50.0706"
												}
											},
											"phone": "1-410-428-1737",
											"website": "kaylin.info",
											"company": {
												"name": "Pfeffer Group",
												"catchPhrase": "User-friendly value-added pricing structure",
												"bs": "cutting-edge disintermediate models"
											},
											"posts": [
												{
													"words": "architecto voluptas qui",
													"sentence": "Qui fugit perspiciatis pariatur reprehenderit velit.",
													"sentences": "Sit et omnis reiciendis ex necessitatibus enim et et. Adipisci aut labore accusantium. Eveniet recusandae ullam praesentium optio laudantium distinctio a. Tempore sequi labore nihil omnis porro. Facilis consequuntur iusto expedita ea repudiandae quia. Pariatur unde corporis placeat at.",
													"paragraph": "Blanditiis non quis autem adipisci. Vero nam quas error dolores incidunt dolor est. Magni dolores quo vero sint quidem est. Aut voluptatem itaque. Nemo eligendi vero sint qui ipsa similique. Soluta molestiae quo qui nisi voluptatem ut exercitationem quia sunt."
												},
												{
													"words": "excepturi natus odit",
													"sentence": "Repudiandae asperiores eaque qui.",
													"sentences": "Et est est et velit non. Autem consequatur ut eveniet distinctio quo.",
													"paragraph": "Repellendus ut voluptatum itaque. Non consectetur et exercitationem aliquam. Voluptas sint nisi magnam libero consequuntur maiores minus itaque. Ullam sequi et ut minima ipsum molestiae maxime."
												},
												{
													"words": "corporis quam et",
													"sentence": "Sint voluptate adipisci enim laudantium reprehenderit facilis quasi beatae ipsam.",
													"sentences": "Ipsa qui sequi quia sequi itaque. Eligendi omnis deserunt velit aut maxime dolorum consequatur sequi. Neque sed laboriosam officia odit molestiae quia quo reiciendis.",
													"paragraph": "Dolores sit id sed ullam illum non enim. Dolores quas omnis culpa minus enim dolorem quis eligendi. Voluptatem nemo nam sit doloribus qui molestias beatae at totam. Qui quo fugiat eos voluptatem. Nostrum assumenda consequatur expedita. Nihil rerum aut molestiae dignissimos voluptate et praesentium."
												}
											],
											"accountHistory": [
												{
													"amount": "31.19",
													"date": "2012-02-02T06:00:00Z",
													"business": "Kirlin, MacGyver and Bradtke",
													"name": "Auto Loan Account 3893",
													"type": "payment",
													"account": "81492295"
												},
												{
													"amount": "820.25",
													"date": "2012-02-02T06:00:00Z",
													"business": "Conroy - Gutmann",
													"name": "Savings Account 6260",
													"type": "payment",
													"account": "18774408"
												},
												{
													"amount": "582.19",
													"date": "2012-02-02T06:00:00Z",
													"business": "Schimmel, Schimmel and Lindgren",
													"name": "Auto Loan Account 9826",
													"type": "payment",
													"account": "99842931"
												}
											],
											"id": "3f1f7b63-3d11-461c-b32c-f2430480e1b2",
											"_etag": "\"49009f9d-0000-0100-0000-5e5017de0000\""
										},
										{
											"_rid": "o9tdAL4WfHEHAAAAAAAAAA==",
											"_ts": 1582307294,
											"name": "Hazle Considine",
											"username": "Ford_Fadel39",
											"email": "Foster.Wisozk6@gmail.com",
											"address": {
												"streetA": "Nelda Lane",
												"streetB": "3447 Annabell Course",
												"streetC": "97365 Fermin Walk Suite 775",
												"streetD": "Apt. 138",
												"city": "Mitchellfurt",
												"state": "Missouri",
												"country": "Serbia",
												"zipcode": "30191-8522",
												"geo": {
													"lat": "72.9413",
													"lng": "75.9263"
												}
											},
											"phone": "948-848-5504",
											"website": "payton.name",
											"company": {
												"name": "Kilback, Steuber and Runolfsdottir",
												"catchPhrase": "Robust zero defect customer loyalty",
												"bs": "integrated evolve e-business"
											},
											"posts": [
												{
													"words": "repellat cum quasi",
													"sentence": "Nihil neque id aut nisi blanditiis pariatur dolorum non repellendus.",
													"sentences": "Exercitationem recusandae fuga modi qui ipsam ut. Quis voluptas adipisci. Ut dolor et voluptatem sed animi veritatis voluptate. Maiores voluptates facere.",
													"paragraph": "Quis atque tempora repellendus molestiae veritatis. Expedita quia facilis ea cum nemo unde asperiores eum voluptatem. Dolorem dicta cumque aspernatur rerum. Laudantium magnam amet voluptate velit temporibus perspiciatis porro magni aliquam. Accusamus asperiores nihil quis soluta voluptate voluptatum officia quod."
												},
												{
													"words": "sint autem itaque",
													"sentence": "Rem ea reprehenderit ea.",
													"sentences": "Ea voluptas dolores eum qui illo. Voluptatem ab enim blanditiis consequatur ducimus incidunt qui dolor et. Recusandae dolor voluptatem. At minima non dolorem labore ullam eum explicabo et.",
													"paragraph": "Atque ut quos deserunt ipsa pariatur. Aut facilis recusandae provident enim eum exercitationem voluptas et. Sit adipisci veritatis quam similique eligendi nostrum perspiciatis et aut. Maiores quae eum illo molestiae quia doloremque dolorem quos omnis. Ipsum et voluptatem voluptas dolore qui nihil id minus."
												},
												{
													"words": "a sed voluptas",
													"sentence": "Molestiae perferendis reiciendis maiores odio.",
													"sentences": "Quia dolorum corrupti ullam quis qui amet sed sed optio. Dolorem non est. Facilis illo in vero voluptatum repellat atque non. Voluptates reiciendis fugit a nesciunt et et voluptas. Quia illo quam officia tenetur et et dolorum. Quo cupiditate quae rem voluptatum quia aut voluptas.",
													"paragraph": "Dolores corporis blanditiis quae molestias sunt ullam sit corporis provident. Voluptatem quos et sunt aut commodi perspiciatis explicabo. Hic accusantium eligendi sunt."
												}
											],
											"accountHistory": [
												{
													"amount": "340.93",
													"date": "2012-02-02T06:00:00Z",
													"business": "Schinner Inc",
													"name": "Checking Account 5055",
													"type": "withdrawal",
													"account": "68363655"
												},
												{
													"amount": "523.31",
													"date": "2012-02-02T06:00:00Z",
													"business": "Schiller - Heller",
													"name": "Savings Account 1680",
													"type": "deposit",
													"account": "82413721"
												},
												{
													"amount": "153.38",
													"date": "2012-02-02T06:00:00Z",
													"business": "Cruickshank, Gulgowski and Ruecker",
													"name": "Money Market Account 1010",
													"type": "withdrawal",
													"account": "68993258"
												}
											],
											"id": "909ce8e4-b70c-4dee-9956-d81f5cfc87bf",
											"_etag": "\"4900a09d-0000-0100-0000-5e5017de0000\""
										},
										{
											"_rid": "o9tdAL4WfHEIAAAAAAAAAA==",
											"_ts": 1582307294,
											"name": "Agustin Considine",
											"username": "Alexis_Blanda",
											"email": "Otha34@gmail.com",
											"address": {
												"streetA": "Vita Bridge",
												"streetB": "868 Rogers Ridge",
												"streetC": "1210 Hirthe Cove Apt. 880",
												"streetD": "Apt. 488",
												"city": "Farrellmouth",
												"state": "South Dakota",
												"country": "Isle of Man",
												"zipcode": "79274",
												"geo": {
													"lat": "-30.3731",
													"lng": "-35.4375"
												}
											},
											"phone": "1-876-734-6281 x35933",
											"website": "maci.org",
											"company": {
												"name": "Brakus and Sons",
												"catchPhrase": "Phased mobile array",
												"bs": "synergistic morph schemas"
											},
											"posts": [
												{
													"words": "voluptatibus similique suscipit",
													"sentence": "Tempora fuga sint sit qui.",
													"sentences": "Aut et ut ea qui. Esse inventore rerum. Dolores vel soluta nihil temporibus tempora iure nobis aut.",
													"paragraph": "Possimus et qui sint asperiores pariatur velit voluptate. Aut quis et ut. Eaque totam qui accusantium dolorem beatae id dolorem nesciunt voluptatem. Consequatur et tenetur rerum."
												},
												{
													"words": "unde dignissimos soluta",
													"sentence": "Debitis laborum consequuntur quis ipsum iste.",
													"sentences": "Nisi consequuntur deserunt commodi quia. Sed nesciunt aut.",
													"paragraph": "Ut reprehenderit cum quia non. Deleniti provident magni animi laboriosam veniam corrupti ut magni. Nam mollitia suscipit. Qui cum quis laudantium doloribus saepe id corporis fugit."
												},
												{
													"words": "eos quibusdam corporis",
													"sentence": "Eum sapiente est numquam doloribus.",
													"sentences": "Optio corporis labore dolore nam magnam nostrum ut ratione rem. Eaque est iste illum nobis quis non. Ipsam voluptate ut tenetur reiciendis dignissimos. Excepturi hic ratione saepe non ut perspiciatis.",
													"paragraph": "Impedit in rerum distinctio quaerat quo vero. Exercitationem sit qui minima iste. Quaerat dolores quod totam itaque est libero ea error. Esse quae fuga nostrum eum."
												}
											],
											"accountHistory": [
												{
													"amount": "12.40",
													"date": "2012-02-02T06:00:00Z",
													"business": "Walker, Hansen and Deckow",
													"name": "Credit Card Account 5193",
													"type": "payment",
													"account": "37266237"
												},
												{
													"amount": "300.24",
													"date": "2012-02-02T06:00:00Z",
													"business": "Blick, Abshire and Hickle",
													"name": "Savings Account 0867",
													"type": "payment",
													"account": "62458571"
												},
												{
													"amount": "16.22",
													"date": "2012-02-02T06:00:00Z",
													"business": "Murphy, Monahan and Kihn",
													"name": "Credit Card Account 3409",
													"type": "invoice",
													"account": "33307585"
												}
											],
											"id": "2d43ffe0-5c21-47e8-8211-2616cad31800",
											"_etag": "\"4900a19d-0000-0100-0000-5e5017de0000\""
										},
										{
											"_rid": "o9tdAL4WfHEJAAAAAAAAAA==",
											"_ts": 1582307294,
											"name": "Miss Kristy Morar",
											"username": "Dayne.Quitzon34",
											"email": "Stewart.Little17@yahoo.com",
											"address": {
												"streetA": "Major Fort",
												"streetB": "23991 Kuhic Burg",
												"streetC": "56488 Reinger Knoll Apt. 145",
												"streetD": "Suite 939",
												"city": "Kuhicstad",
												"state": "Hawaii",
												"country": "Denmark",
												"zipcode": "00513",
												"geo": {
													"lat": "-4.0130",
													"lng": "116.2772"
												}
											},
											"phone": "1-320-766-5988 x508",
											"website": "jack.net",
											"company": {
												"name": "Reynolds Inc",
												"catchPhrase": "Cloned actuating monitoring",
												"bs": "plug-and-play synthesize web services"
											},
											"posts": [
												{
													"words": "possimus commodi amet",
													"sentence": "Dolorem debitis id eveniet aut et distinctio nesciunt.",
													"sentences": "Sint et aperiam nulla nihil quo. Et perspiciatis quo. Similique facere ut et rerum. Ad quos doloribus ratione suscipit facilis assumenda facere.",
													"paragraph": "Magni vero fuga ex itaque autem laudantium. Vitae cupiditate non. Consequatur alias tempore expedita eum. Quibusdam qui dolor sit sint fuga error perspiciatis libero."
												},
												{
													"words": "et sequi rerum",
													"sentence": "Dolor earum mollitia.",
													"sentences": "Adipisci eveniet vitae. Accusamus ab ut maxime sunt enim. Minima qui vero explicabo. Amet nam quibusdam esse impedit velit tempora qui quis eum. Quis accusantium inventore quia sequi rerum est.",
													"paragraph": "Placeat qui dolorem dolore sint itaque aliquid quia. Excepturi amet placeat repudiandae deleniti expedita. Molestiae sit placeat. Dolor ipsa libero dolores aut. Sunt rerum laborum cupiditate temporibus."
												},
												{
													"words": "et minima odio",
													"sentence": "Explicabo sit iure excepturi perferendis quae illo consequuntur a.",
													"sentences": "Et sunt est molestiae eos. Pariatur quia perspiciatis itaque illum deleniti laboriosam ea libero. Illo ratione sunt deserunt non ab aperiam qui ut impedit. Doloremque pariatur et illo esse. Dolorum qui est. Eligendi eos magni dolores sed ratione sit tempora.",
													"paragraph": "Enim praesentium laborum eligendi cumque error eum sit error nihil. Consequatur consectetur quibusdam beatae magni deleniti labore cum consequatur similique. Qui in sequi sint ut natus nemo. Excepturi recusandae quo ut tenetur rerum. Iusto doloribus totam. Cum repellat commodi quo libero mollitia earum architecto culpa."
												}
											],
											"accountHistory": [
												{
													"amount": "886.87",
													"date": "2012-02-02T06:00:00Z",
													"business": "Heathcote and Sons",
													"name": "Auto Loan Account 2241",
													"type": "deposit",
													"account": "55402733"
												},
												{
													"amount": "877.45",
													"date": "2012-02-02T06:00:00Z",
													"business": "Murphy LLC",
													"name": "Credit Card Account 5085",
													"type": "deposit",
													"account": "51731576"
												},
												{
													"amount": "562.38",
													"date": "2012-02-02T06:00:00Z",
													"business": "Shields and Sons",
													"name": "Savings Account 6181",
													"type": "deposit",
													"account": "44589641"
												}
											],
											"id": "a3e45cd7-f0aa-4600-a9b5-6219f83b4017",
											"_etag": "\"4900a29d-0000-0100-0000-5e5017de0000\""
										},
										{
											"_rid": "o9tdAL4WfHEKAAAAAAAAAA==",
											"_ts": 1582307294,
											"name": "Bud Reilly",
											"username": "Makenzie44",
											"email": "Arne_Aufderhar43@yahoo.com",
											"address": {
												"streetA": "Alexie Cliff",
												"streetB": "5464 Ava Pines",
												"streetC": "12665 Janice Stravenue Apt. 941",
												"streetD": "Apt. 261",
												"city": "East Leonoramouth",
												"state": "Illinois",
												"country": "Burkina Faso",
												"zipcode": "62981",
												"geo": {
													"lat": "3.8307",
													"lng": "-43.1132"
												}
											},
											"phone": "217.918.0206 x0478",
											"website": "arely.com",
											"company": {
												"name": "Watsica, Zemlak and Nitzsche",
												"catchPhrase": "Balanced analyzing policy",
												"bs": "scalable expedite content"
											},
											"posts": [
												{
													"words": "qui qui doloribus",
													"sentence": "Ex molestias ea molestiae qui excepturi qui maiores.",
													"sentences": "Aut aliquid est asperiores ut iure nostrum qui asperiores. Doloremque maiores error eaque ut eveniet similique dolorem. Ipsam qui explicabo perferendis explicabo. Quaerat aut totam dicta totam ut consequatur repellendus itaque. Nihil ullam voluptatem eaque praesentium dolorem dicta.",
													"paragraph": "Totam ab nisi sit nobis totam quis eos. Non explicabo autem quam illum ut totam. Minus ab soluta saepe maxime. Ut voluptate amet ut nihil. Voluptatem ipsa maxime et."
												},
												{
													"words": "commodi et eos",
													"sentence": "Aliquid omnis asperiores dolorem distinctio voluptatem dolorem a.",
													"sentences": "Quaerat distinctio dolorem. Ut est qui omnis nostrum sed rem. Et praesentium sunt amet fuga commodi aliquam autem voluptates quod. Quibusdam non perferendis facilis odit molestiae officia eum.",
													"paragraph": "Et nobis tempore reprehenderit dolorum qui autem inventore. Ab qui dolor est inventore quidem animi quae. Quis harum ea perspiciatis fugiat ut placeat quia sit ut. Illum animi laboriosam voluptatibus."
												},
												{
													"words": "sed quia odio",
													"sentence": "Suscipit labore earum minima magni accusantium et.",
													"sentences": "Necessitatibus enim voluptas maiores aspernatur sint. Tempore est consequuntur deserunt omnis occaecati perferendis voluptates. Quas enim excepturi quisquam repellendus hic possimus quam a. Fuga blanditiis porro est nisi ipsa ratione est delectus. Est voluptate quae sapiente nulla similique officia atque voluptatem possimus.",
													"paragraph": "Nemo nisi soluta consequatur et eaque impedit eveniet. Et fuga natus cupiditate quo quisquam laudantium voluptatum. Ut consequatur delectus rem in numquam omnis blanditiis enim."
												}
											],
											"accountHistory": [
												{
													"amount": "533.55",
													"date": "2012-02-02T06:00:00Z",
													"business": "Bosco - Lebsack",
													"name": "Personal Loan Account 9457",
													"type": "deposit",
													"account": "98108779"
												},
												{
													"amount": "99.42",
													"date": "2012-02-02T06:00:00Z",
													"business": "Heaney Inc",
													"name": "Credit Card Account 8115",
													"type": "withdrawal",
													"account": "91604810"
												},
												{
													"amount": "802.40",
													"date": "2012-02-02T06:00:00Z",
													"business": "Ondricka and Sons",
													"name": "Investment Account 1659",
													"type": "withdrawal",
													"account": "64273944"
												}
											],
											"id": "2fb72289-203f-4af8-ab90-c831ea28bfbe",
											"_etag": "\"4900a39d-0000-0100-0000-5e5017de0000\""
										},
										{
											"_rid": "o9tdAL4WfHELAAAAAAAAAA==",
											"_ts": 1582307294,
											"name": "Mr. Donna Schulist",
											"username": "Columbus17",
											"email": "Collin_Klein69@gmail.com",
											"address": {
												"streetA": "Stiedemann Shore",
												"streetB": "1427 Nathen Meadow",
												"streetC": "2082 Nakia Brooks Apt. 297",
												"streetD": "Suite 972",
												"city": "North Ernie",
												"state": "Rhode Island",
												"country": "Antarctica (the territory South of 60 deg S)",
												"zipcode": "74877-0697",
												"geo": {
													"lat": "-50.2651",
													"lng": "-139.8912"
												}
											},
											"phone": "1-124-398-5659",
											"website": "marie.net",
											"company": {
												"name": "Hauck, Klein and Kunde",
												"catchPhrase": "Object-based secondary migration",
												"bs": "bleeding-edge generate networks"
											},
											"posts": [
												{
													"words": "ducimus sit amet",
													"sentence": "Ad eos optio iusto perspiciatis.",
													"sentences": "Ullam error aliquid cupiditate ut enim delectus modi nobis autem. Eum dolorum blanditiis in quae ipsa est et. Et minima eos aut explicabo repellendus eligendi voluptatem quo. Assumenda aut fugit perspiciatis. Vel nihil quam in exercitationem assumenda nulla.",
													"paragraph": "Deserunt velit enim soluta quis qui. Quia eligendi eaque veritatis maxime odit nobis deserunt reiciendis quaerat. Accusamus minima non saepe delectus. Qui omnis rem non inventore. Aut ut voluptates nesciunt ut et. Eum ut dolorem harum officiis animi et sed."
												},
												{
													"words": "rerum quam nam",
													"sentence": "Harum doloremque omnis qui et.",
													"sentences": "Corrupti fugiat neque perferendis omnis maiores. Nihil et soluta qui dolor enim doloremque quibusdam. Voluptatem deleniti voluptates. Nobis autem sit. Itaque neque ipsam neque voluptatum dolor modi. Consequatur ea ad ad atque voluptatibus praesentium quae consectetur.",
													"paragraph": "Ea ab blanditiis iure numquam ut. Facilis ea culpa et provident facere optio rerum. Autem nostrum nesciunt saepe autem et iusto et omnis omnis. Consequatur quis occaecati rerum nam tempore rem omnis quo aut. Fugiat eos id ut quaerat itaque maxime similique. Maiores voluptas minus explicabo adipisci inventore voluptas."
												},
												{
													"words": "occaecati ipsam reprehenderit",
													"sentence": "Corporis atque amet reprehenderit accusantium optio nihil consequatur.",
													"sentences": "Sint vel nam. Quis ullam iusto in quod aperiam in ut et. Voluptas accusantium beatae dolorum quia. Qui blanditiis et numquam doloribus dolorem. Voluptatem dolor nostrum ullam ut doloribus.",
													"paragraph": "Accusantium molestiae dolor modi ab. Facilis maiores eaque aperiam tempore. Alias officia id dicta."
												}
											],
											"accountHistory": [
												{
													"amount": "570.16",
													"date": "2012-02-02T06:00:00Z",
													"business": "Kerluke and Sons",
													"name": "Money Market Account 9806",
													"type": "invoice",
													"account": "20090939"
												},
												{
													"amount": "740.25",
													"date": "2012-02-02T06:00:00Z",
													"business": "Christiansen Group",
													"name": "Credit Card Account 1649",
													"type": "payment",
													"account": "63026960"
												},
												{
													"amount": "934.61",
													"date": "2012-02-02T06:00:00Z",
													"business": "Leannon Group",
													"name": "Checking Account 7266",
													"type": "invoice",
													"account": "38936695"
												}
											],
											"id": "6f0c7dcf-2afd-4fa8-8f57-bcac1ea63d1f",
											"_etag": "\"4900a49d-0000-0100-0000-5e5017de0000\""
										},
										{
											"_rid": "o9tdAL4WfHEMAAAAAAAAAA==",
											"_ts": 1582307294,
											"name": "Mrs. Aracely McCullough",
											"username": "Daron_Rosenbaum73",
											"email": "Daphnee.Morar76@hotmail.com",
											"address": {
												"streetA": "Metz Stravenue",
												"streetB": "2549 Mckenna Lane",
												"streetC": "10808 Jeffery Rue Apt. 920",
												"streetD": "Suite 638",
												"city": "New Janickberg",
												"state": "Alaska",
												"country": "Japan",
												"zipcode": "85419",
												"geo": {
													"lat": "-27.5246",
													"lng": "-49.6258"
												}
											},
											"phone": "(951) 837-3822 x995",
											"website": "reid.com",
											"company": {
												"name": "Koss, Fahey and Glover",
												"catchPhrase": "Ergonomic non-volatile customer loyalty",
												"bs": "sticky matrix networks"
											},
											"posts": [
												{
													"words": "rerum fuga pariatur",
													"sentence": "Voluptas doloribus expedita eos ratione rerum nulla.",
													"sentences": "Beatae deleniti est. Sapiente eos ad quasi nobis. Et odit odit pariatur. Quia dolores nostrum quo. Est et est neque exercitationem et quaerat itaque quidem. Ducimus ducimus quisquam.",
													"paragraph": "Neque optio odit voluptatem doloremque consequuntur quas temporibus. Expedita accusamus minima perferendis expedita. Doloremque hic sit magnam nostrum quaerat. Tempora optio sunt adipisci assumenda vero maxime fugiat corporis. Et dolorum laboriosam tempora. Ipsum et blanditiis voluptatum ex accusantium in."
												},
												{
													"words": "iure praesentium consectetur",
													"sentence": "Corrupti rerum quos aperiam veniam ducimus beatae rem.",
													"sentences": "Aliquid nam consequatur commodi laboriosam ratione atque quod in dolore. Vel excepturi est dolorem laboriosam dicta cumque perferendis. Et eveniet qui dicta nesciunt est laborum.",
													"paragraph": "Pariatur consequatur sapiente sunt sunt est sapiente sit quibusdam nisi. Ipsum magnam blanditiis dolore. Iure qui maxime nihil."
												},
												{
													"words": "maiores commodi numquam",
													"sentence": "Soluta rerum nostrum tempore aliquam consequatur.",
													"sentences": "Magni iste rerum expedita dolor. Fugit assumenda voluptatibus. Rerum provident unde velit et vel commodi.",
													"paragraph": "Sunt aliquam veritatis error rerum voluptas. Nobis eos id sunt deserunt voluptate repudiandae enim sit vitae. Qui voluptas voluptas mollitia sint et dolore."
												}
											],
											"accountHistory": [
												{
													"amount": "764.07",
													"date": "2012-02-02T06:00:00Z",
													"business": "Murphy Inc",
													"name": "Personal Loan Account 4413",
													"type": "deposit",
													"account": "71685060"
												},
												{
													"amount": "427.36",
													"date": "2012-02-02T06:00:00Z",
													"business": "Braun - Bradtke",
													"name": "Checking Account 8921",
													"type": "deposit",
													"account": "33789939"
												},
												{
													"amount": "736.58",
													"date": "2012-02-02T06:00:00Z",
													"business": "Dietrich - Casper",
													"name": "Auto Loan Account 3973",
													"type": "payment",
													"account": "47930479"
												}
											],
											"id": "e84a297c-41a1-4eb8-9eb0-b290d2850f7a",
											"_etag": "\"4900a59d-0000-0100-0000-5e5017de0000\""
										},
										{
											"_rid": "o9tdAL4WfHENAAAAAAAAAA==",
											"_ts": 1582307294,
											"name": "Adriel Stamm IV",
											"username": "Ahmed.Adams",
											"email": "Zaria_DuBuque45@hotmail.com",
											"address": {
												"streetA": "Osinski Dale",
												"streetB": "05058 Wilhelm Pines",
												"streetC": "726 Blaise Overpass Suite 342",
												"streetD": "Suite 129",
												"city": "Dillanville",
												"state": "Arkansas",
												"country": "Moldova",
												"zipcode": "78862",
												"geo": {
													"lat": "10.7978",
													"lng": "159.5776"
												}
											},
											"phone": "075-655-7393",
											"website": "dandre.net",
											"company": {
												"name": "Skiles, Kreiger and Jacobson",
												"catchPhrase": "Focused global forecast",
												"bs": "distributed transform infrastructures"
											},
											"posts": [
												{
													"words": "incidunt odio amet",
													"sentence": "Consequatur fugiat alias necessitatibus doloremque quia ducimus tempora.",
													"sentences": "Nihil excepturi ea illo optio vel sed rerum possimus. Earum similique aut. Et saepe et. Sed sed mollitia non totam aliquam totam quis aliquid iusto. Illum consequatur dolores corporis repellat sint neque. Ipsum accusantium reiciendis in.",
													"paragraph": "Dolor nulla voluptatibus qui. Minus quisquam architecto. Sint dolores culpa voluptatem et optio pariatur sequi nostrum. Tempore reprehenderit ratione aliquid optio. Distinctio ad dolores nesciunt a aliquid natus sequi ipsam."
												},
												{
													"words": "aut eum recusandae",
													"sentence": "Veniam assumenda culpa vero odit.",
													"sentences": "Molestiae sit voluptatem eum facere ut accusamus magni. Vitae quasi pariatur iusto est nihil quaerat ipsum voluptatem placeat. Neque voluptatem id. Repudiandae beatae commodi.",
													"paragraph": "Suscipit illo suscipit architecto illum voluptatibus. Sit omnis nesciunt laudantium sapiente omnis. Hic in aliquam magni. Totam maxime mollitia officiis nam ullam non magnam vel. Illo quaerat autem autem ea tempora odit. Repellendus nihil libero voluptatem aut vel qui ut quasi."
												},
												{
													"words": "est rerum incidunt",
													"sentence": "Beatae beatae architecto iusto.",
													"sentences": "Animi est ut cumque nihil. Aut omnis quasi similique fugiat non officiis. Et tempora qui accusantium mollitia aut. Reprehenderit error labore quia neque.",
													"paragraph": "Amet consequatur non corrupti veritatis est. Ipsum repellat consequuntur. Itaque repellendus sapiente laborum rerum delectus tempore eum iusto sed. Temporibus qui qui odit cupiditate sunt aut nesciunt cum. Perferendis nostrum iure ad ipsum eum est exercitationem nisi cum."
												}
											],
											"accountHistory": [
												{
													"amount": "470.85",
													"date": "2012-02-02T06:00:00Z",
													"business": "Friesen - Kris",
													"name": "Personal Loan Account 6101",
													"type": "withdrawal",
													"account": "97062153"
												},
												{
													"amount": "589.03",
													"date": "2012-02-02T06:00:00Z",
													"business": "O'Connell, Crooks and Wunsch",
													"name": "Credit Card Account 7896",
													"type": "withdrawal",
													"account": "93983669"
												},
												{
													"amount": "973.76",
													"date": "2012-02-02T06:00:00Z",
													"business": "Murphy, Little and Russel",
													"name": "Savings Account 8382",
													"type": "withdrawal",
													"account": "90864486"
												}
											],
											"id": "61807ebb-7971-4b3a-848c-78850c8a867a",
											"_etag": "\"4900a69d-0000-0100-0000-5e5017de0000\""
										}
									],
									"schema": {
										"_rid": "string",
										"_ts": "bigint",
										"name": "string",
										"username": "string",
										"email": "string",
										"address": "struct<streetA:string,streetB:string,streetC:string,streetD:string,city:string,state:string,country:string,zipcode:string,geo:struct<lat:string,lng:string>>",
										"phone": "string",
										"website": "string",
										"company": "struct<name:string,catchPhrase:string,bs:string>",
										"posts": "array<struct<words:string,sentence:string,sentences:string,paragraph:string>>",
										"accountHistory": "array<struct<amount:string,date:string,business:string,name:string,type:string,account:string>>",
										"id": "string",
										"_etag": "string"
									},
									"filter": null
								},
								"aggData": {
									"_rid": {
										"o9tdAL4WfHEDAAAAAAAAAA==": 1,
										"o9tdAL4WfHEFAAAAAAAAAA==": 1,
										"o9tdAL4WfHEGAAAAAAAAAA==": 1,
										"o9tdAL4WfHEHAAAAAAAAAA==": 1,
										"o9tdAL4WfHEIAAAAAAAAAA==": 1,
										"o9tdAL4WfHEJAAAAAAAAAA==": 1,
										"o9tdAL4WfHEKAAAAAAAAAA==": 1,
										"o9tdAL4WfHELAAAAAAAAAA==": 1,
										"o9tdAL4WfHEMAAAAAAAAAA==": 1,
										"o9tdAL4WfHENAAAAAAAAAA==": 1
									}
								},
								"isSummary": false,
								"isSql": false
							}
						},
						"source": [
							"display(df_retail_data.limit(10))"
						],
						"outputs": [],
						"execution_count": 5
					},
					{
						"cell_type": "code",
						"source": [
							"df_retail_data.printSchema()"
						],
						"outputs": [],
						"execution_count": 6
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Create a Spark Table through linked Service\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"%%spark \n",
							"   \n",
							"spark.sql(\n",
							"      s\"\"\"create table DemoCosmosDB using cosmos.olap options(\n",
							"        | spark.cosmos.synapse.linkedServiceName 'CosmosDBLink',\n",
							"        | spark.cosmos.region 'west us 2',\n",
							"        | spark.cosmos.databaseName 'sample-db-001',\n",
							"        | spark.cosmos.containerName 'sample-container-001')\n",
							"      \"\"\".stripMargin)\n",
							"      "
						],
						"outputs": [],
						"execution_count": 7
					},
					{
						"cell_type": "code",
						"source": [
							"%%spark\n",
							"spark.sql(\"SELECT count(*) FROM DemoCosmosDB\").show()"
						],
						"outputs": [],
						"execution_count": 8
					},
					{
						"cell_type": "code",
						"metadata": {
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [],
									"values": [],
									"yLabel": "",
									"xLabel": "",
									"aggregation": "COUNT",
									"aggByBackend": false
								},
								"previewData": {
									"rows": [
										[
											"o9tdAL4WfHEDAAAAAAAAAA==",
											1582307294,
											"Jillian Schroeder",
											"Maurice_Sawayn",
											"Priscilla_Jones@hotmail.com",
											{
												"schema": [
													{
														"name": "streetA",
														"nullable": true
													},
													{
														"name": "streetB",
														"nullable": true
													},
													{
														"name": "streetC",
														"nullable": true
													},
													{
														"name": "streetD",
														"nullable": true
													},
													{
														"name": "city",
														"nullable": true
													},
													{
														"name": "state",
														"nullable": true
													},
													{
														"name": "country",
														"nullable": true
													},
													{
														"name": "zipcode",
														"nullable": true
													},
													{
														"name": "geo",
														"dataType": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"nullable": true
													}
												],
												"values": [
													"Baumbach Center",
													"441 Shanon Fords",
													"41296 Mckenna Cove Apt. 434",
													"Apt. 818",
													"Lake Aglaetown",
													"Indiana",
													"Tuvalu",
													"06441",
													{
														"schema": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"values": [
															"-34.7248",
															"22.1263"
														]
													}
												]
											},
											"1-928-355-8933",
											"faye.org",
											{
												"schema": [
													{
														"name": "name",
														"nullable": true
													},
													{
														"name": "catchPhrase",
														"nullable": true
													},
													{
														"name": "bs",
														"nullable": true
													}
												],
												"values": [
													"Zemlak - Hyatt",
													"Adaptive 3rd generation strategy",
													"scalable exploit partnerships"
												]
											},
											[
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"et sed omnis",
														"Sed nobis odio.",
														"Sapiente delectus ipsa quasi optio fuga tempore. At ratione ab provident ut ut dolores vero corporis.",
														"Voluptas pariatur sint dolor ut aliquid molestiae facilis architecto. Nemo ut consequuntur quidem cum omnis. Dolore quae corporis placeat beatae voluptate et in mollitia. Nobis veniam aliquam error. Molestiae eos sapiente."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"repellendus molestias sed",
														"Accusantium accusantium exercitationem.",
														"Eius et voluptatem nisi voluptates in unde accusamus qui. Voluptatum voluptatibus ratione veritatis doloremque quo ut. Quia odit et ipsam corrupti ducimus qui eum maiores. Eveniet nesciunt molestiae et molestiae.",
														"Sequi est consequatur est ad magnam quidem. Quisquam ut natus fugiat libero tempore magni quis quas quidem. Aspernatur eligendi et ratione repudiandae sit."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"sed dolorem sint",
														"Sit consectetur magni natus doloribus.",
														"Optio debitis fugit facere iusto ex modi aliquam. Illum quod et maxime accusamus laborum natus veritatis.",
														"Autem dolores dolor expedita sapiente ex cum eligendi iusto adipisci. Minus facilis delectus quo. In corporis mollitia molestiae. Vel voluptas optio."
													]
												}
											],
											[
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"107.62",
														"2012-02-02T06:00:00Z",
														"Roob LLC",
														"Home Loan Account 6220",
														"payment",
														"03705510"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"650.88",
														"2012-02-02T06:00:00Z",
														"Kuphal, Lynch and Pouros",
														"Checking Account 9001",
														"payment",
														"85352791"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"878.63",
														"2012-02-02T06:00:00Z",
														"Reynolds Group",
														"Money Market Account 8743",
														"deposit",
														"53230334"
													]
												}
											],
											"f8f1b82c-27ff-4dc2-b51e-854f6867030b",
											"\"49009c9d-0000-0100-0000-5e5017de0000\""
										],
										[
											"o9tdAL4WfHEFAAAAAAAAAA==",
											1582307294,
											"Lon Steuber",
											"Tiffany.Dibbert",
											"Elliott.Runolfsson@yahoo.com",
											{
												"schema": [
													{
														"name": "streetA",
														"nullable": true
													},
													{
														"name": "streetB",
														"nullable": true
													},
													{
														"name": "streetC",
														"nullable": true
													},
													{
														"name": "streetD",
														"nullable": true
													},
													{
														"name": "city",
														"nullable": true
													},
													{
														"name": "state",
														"nullable": true
													},
													{
														"name": "country",
														"nullable": true
													},
													{
														"name": "zipcode",
														"nullable": true
													},
													{
														"name": "geo",
														"dataType": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"nullable": true
													}
												],
												"values": [
													"Renner Ridge",
													"9414 Peggie Turnpike",
													"57322 Johnson Streets Apt. 039",
													"Apt. 117",
													"Croninfurt",
													"Nebraska",
													"Mozambique",
													"43537",
													{
														"schema": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"values": [
															"21.8544",
															"-15.5911"
														]
													}
												]
											},
											"1-578-998-1626 x882",
											"madalyn.net",
											{
												"schema": [
													{
														"name": "name",
														"nullable": true
													},
													{
														"name": "catchPhrase",
														"nullable": true
													},
													{
														"name": "bs",
														"nullable": true
													}
												],
												"values": [
													"Zieme Group",
													"Versatile web-enabled ability",
													"ubiquitous envisioneer action-items"
												]
											},
											[
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"dignissimos et deleniti",
														"Et eligendi id officia voluptatem sint voluptas assumenda eligendi.",
														"Eveniet omnis ut ad consequuntur. Asperiores sunt occaecati possimus facilis dolore soluta architecto. Voluptatum enim tempora officia occaecati eius deserunt facilis cumque reprehenderit.",
														"Commodi provident in tenetur quis saepe ducimus corporis cupiditate totam. Ad corrupti culpa in quasi nesciunt nisi velit. Velit repellendus eum qui quo."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"corrupti rerum voluptate",
														"Nobis rerum occaecati rem excepturi vel vel.",
														"Voluptatem eos a. Eius nihil voluptatem qui. Minima voluptas sed quasi iusto. Repudiandae repudiandae et hic ipsum aut numquam aspernatur. Atque beatae sed animi facere necessitatibus quod rem. Adipisci sapiente quisquam doloribus provident.",
														"Totam inventore dolor animi omnis. Sequi hic a magni iure temporibus ratione exercitationem quis. Perferendis qui eum quo non voluptatem et eum."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"distinctio et quis",
														"Eum adipisci aut.",
														"Modi cupiditate quo doloribus eius libero. Quas sint fuga quod. Accusantium quia quidem. Sapiente ab impedit exercitationem ut error quia. Laudantium ipsam doloremque dolores alias. Quae saepe qui rerum enim.",
														"Molestiae reiciendis repudiandae voluptates quasi in ut. Dolores sequi sapiente. Aperiam sed dolores voluptatibus doloremque voluptatem."
													]
												}
											],
											[
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"602.45",
														"2012-02-02T06:00:00Z",
														"Price Inc",
														"Personal Loan Account 9924",
														"deposit",
														"61871935"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"377.08",
														"2012-02-02T06:00:00Z",
														"Swaniawski - Barton",
														"Investment Account 1002",
														"withdrawal",
														"24221301"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"204.44",
														"2012-02-02T06:00:00Z",
														"Hilpert, Carroll and Kutch",
														"Auto Loan Account 2452",
														"withdrawal",
														"15660473"
													]
												}
											],
											"a429da80-1c6a-464e-98bf-ca1f0dab236a",
											"\"49009e9d-0000-0100-0000-5e5017de0000\""
										],
										[
											"o9tdAL4WfHEGAAAAAAAAAA==",
											1582307294,
											"Fern Barton",
											"Troy64",
											"Iva.Quigley95@gmail.com",
											{
												"schema": [
													{
														"name": "streetA",
														"nullable": true
													},
													{
														"name": "streetB",
														"nullable": true
													},
													{
														"name": "streetC",
														"nullable": true
													},
													{
														"name": "streetD",
														"nullable": true
													},
													{
														"name": "city",
														"nullable": true
													},
													{
														"name": "state",
														"nullable": true
													},
													{
														"name": "country",
														"nullable": true
													},
													{
														"name": "zipcode",
														"nullable": true
													},
													{
														"name": "geo",
														"dataType": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"nullable": true
													}
												],
												"values": [
													"Junior Key",
													"812 Pamela Corner",
													"948 Willms Passage Suite 826",
													"Apt. 968",
													"Stoltenbergtown",
													"Louisiana",
													"Central African Republic",
													"42760-7544",
													{
														"schema": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"values": [
															"-67.1468",
															"-50.0706"
														]
													}
												]
											},
											"1-410-428-1737",
											"kaylin.info",
											{
												"schema": [
													{
														"name": "name",
														"nullable": true
													},
													{
														"name": "catchPhrase",
														"nullable": true
													},
													{
														"name": "bs",
														"nullable": true
													}
												],
												"values": [
													"Pfeffer Group",
													"User-friendly value-added pricing structure",
													"cutting-edge disintermediate models"
												]
											},
											[
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"architecto voluptas qui",
														"Qui fugit perspiciatis pariatur reprehenderit velit.",
														"Sit et omnis reiciendis ex necessitatibus enim et et. Adipisci aut labore accusantium. Eveniet recusandae ullam praesentium optio laudantium distinctio a. Tempore sequi labore nihil omnis porro. Facilis consequuntur iusto expedita ea repudiandae quia. Pariatur unde corporis placeat at.",
														"Blanditiis non quis autem adipisci. Vero nam quas error dolores incidunt dolor est. Magni dolores quo vero sint quidem est. Aut voluptatem itaque. Nemo eligendi vero sint qui ipsa similique. Soluta molestiae quo qui nisi voluptatem ut exercitationem quia sunt."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"excepturi natus odit",
														"Repudiandae asperiores eaque qui.",
														"Et est est et velit non. Autem consequatur ut eveniet distinctio quo.",
														"Repellendus ut voluptatum itaque. Non consectetur et exercitationem aliquam. Voluptas sint nisi magnam libero consequuntur maiores minus itaque. Ullam sequi et ut minima ipsum molestiae maxime."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"corporis quam et",
														"Sint voluptate adipisci enim laudantium reprehenderit facilis quasi beatae ipsam.",
														"Ipsa qui sequi quia sequi itaque. Eligendi omnis deserunt velit aut maxime dolorum consequatur sequi. Neque sed laboriosam officia odit molestiae quia quo reiciendis.",
														"Dolores sit id sed ullam illum non enim. Dolores quas omnis culpa minus enim dolorem quis eligendi. Voluptatem nemo nam sit doloribus qui molestias beatae at totam. Qui quo fugiat eos voluptatem. Nostrum assumenda consequatur expedita. Nihil rerum aut molestiae dignissimos voluptate et praesentium."
													]
												}
											],
											[
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"31.19",
														"2012-02-02T06:00:00Z",
														"Kirlin, MacGyver and Bradtke",
														"Auto Loan Account 3893",
														"payment",
														"81492295"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"820.25",
														"2012-02-02T06:00:00Z",
														"Conroy - Gutmann",
														"Savings Account 6260",
														"payment",
														"18774408"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"582.19",
														"2012-02-02T06:00:00Z",
														"Schimmel, Schimmel and Lindgren",
														"Auto Loan Account 9826",
														"payment",
														"99842931"
													]
												}
											],
											"3f1f7b63-3d11-461c-b32c-f2430480e1b2",
											"\"49009f9d-0000-0100-0000-5e5017de0000\""
										],
										[
											"o9tdAL4WfHEHAAAAAAAAAA==",
											1582307294,
											"Hazle Considine",
											"Ford_Fadel39",
											"Foster.Wisozk6@gmail.com",
											{
												"schema": [
													{
														"name": "streetA",
														"nullable": true
													},
													{
														"name": "streetB",
														"nullable": true
													},
													{
														"name": "streetC",
														"nullable": true
													},
													{
														"name": "streetD",
														"nullable": true
													},
													{
														"name": "city",
														"nullable": true
													},
													{
														"name": "state",
														"nullable": true
													},
													{
														"name": "country",
														"nullable": true
													},
													{
														"name": "zipcode",
														"nullable": true
													},
													{
														"name": "geo",
														"dataType": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"nullable": true
													}
												],
												"values": [
													"Nelda Lane",
													"3447 Annabell Course",
													"97365 Fermin Walk Suite 775",
													"Apt. 138",
													"Mitchellfurt",
													"Missouri",
													"Serbia",
													"30191-8522",
													{
														"schema": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"values": [
															"72.9413",
															"75.9263"
														]
													}
												]
											},
											"948-848-5504",
											"payton.name",
											{
												"schema": [
													{
														"name": "name",
														"nullable": true
													},
													{
														"name": "catchPhrase",
														"nullable": true
													},
													{
														"name": "bs",
														"nullable": true
													}
												],
												"values": [
													"Kilback, Steuber and Runolfsdottir",
													"Robust zero defect customer loyalty",
													"integrated evolve e-business"
												]
											},
											[
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"repellat cum quasi",
														"Nihil neque id aut nisi blanditiis pariatur dolorum non repellendus.",
														"Exercitationem recusandae fuga modi qui ipsam ut. Quis voluptas adipisci. Ut dolor et voluptatem sed animi veritatis voluptate. Maiores voluptates facere.",
														"Quis atque tempora repellendus molestiae veritatis. Expedita quia facilis ea cum nemo unde asperiores eum voluptatem. Dolorem dicta cumque aspernatur rerum. Laudantium magnam amet voluptate velit temporibus perspiciatis porro magni aliquam. Accusamus asperiores nihil quis soluta voluptate voluptatum officia quod."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"sint autem itaque",
														"Rem ea reprehenderit ea.",
														"Ea voluptas dolores eum qui illo. Voluptatem ab enim blanditiis consequatur ducimus incidunt qui dolor et. Recusandae dolor voluptatem. At minima non dolorem labore ullam eum explicabo et.",
														"Atque ut quos deserunt ipsa pariatur. Aut facilis recusandae provident enim eum exercitationem voluptas et. Sit adipisci veritatis quam similique eligendi nostrum perspiciatis et aut. Maiores quae eum illo molestiae quia doloremque dolorem quos omnis. Ipsum et voluptatem voluptas dolore qui nihil id minus."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"a sed voluptas",
														"Molestiae perferendis reiciendis maiores odio.",
														"Quia dolorum corrupti ullam quis qui amet sed sed optio. Dolorem non est. Facilis illo in vero voluptatum repellat atque non. Voluptates reiciendis fugit a nesciunt et et voluptas. Quia illo quam officia tenetur et et dolorum. Quo cupiditate quae rem voluptatum quia aut voluptas.",
														"Dolores corporis blanditiis quae molestias sunt ullam sit corporis provident. Voluptatem quos et sunt aut commodi perspiciatis explicabo. Hic accusantium eligendi sunt."
													]
												}
											],
											[
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"340.93",
														"2012-02-02T06:00:00Z",
														"Schinner Inc",
														"Checking Account 5055",
														"withdrawal",
														"68363655"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"523.31",
														"2012-02-02T06:00:00Z",
														"Schiller - Heller",
														"Savings Account 1680",
														"deposit",
														"82413721"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"153.38",
														"2012-02-02T06:00:00Z",
														"Cruickshank, Gulgowski and Ruecker",
														"Money Market Account 1010",
														"withdrawal",
														"68993258"
													]
												}
											],
											"909ce8e4-b70c-4dee-9956-d81f5cfc87bf",
											"\"4900a09d-0000-0100-0000-5e5017de0000\""
										],
										[
											"o9tdAL4WfHEIAAAAAAAAAA==",
											1582307294,
											"Agustin Considine",
											"Alexis_Blanda",
											"Otha34@gmail.com",
											{
												"schema": [
													{
														"name": "streetA",
														"nullable": true
													},
													{
														"name": "streetB",
														"nullable": true
													},
													{
														"name": "streetC",
														"nullable": true
													},
													{
														"name": "streetD",
														"nullable": true
													},
													{
														"name": "city",
														"nullable": true
													},
													{
														"name": "state",
														"nullable": true
													},
													{
														"name": "country",
														"nullable": true
													},
													{
														"name": "zipcode",
														"nullable": true
													},
													{
														"name": "geo",
														"dataType": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"nullable": true
													}
												],
												"values": [
													"Vita Bridge",
													"868 Rogers Ridge",
													"1210 Hirthe Cove Apt. 880",
													"Apt. 488",
													"Farrellmouth",
													"South Dakota",
													"Isle of Man",
													"79274",
													{
														"schema": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"values": [
															"-30.3731",
															"-35.4375"
														]
													}
												]
											},
											"1-876-734-6281 x35933",
											"maci.org",
											{
												"schema": [
													{
														"name": "name",
														"nullable": true
													},
													{
														"name": "catchPhrase",
														"nullable": true
													},
													{
														"name": "bs",
														"nullable": true
													}
												],
												"values": [
													"Brakus and Sons",
													"Phased mobile array",
													"synergistic morph schemas"
												]
											},
											[
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"voluptatibus similique suscipit",
														"Tempora fuga sint sit qui.",
														"Aut et ut ea qui. Esse inventore rerum. Dolores vel soluta nihil temporibus tempora iure nobis aut.",
														"Possimus et qui sint asperiores pariatur velit voluptate. Aut quis et ut. Eaque totam qui accusantium dolorem beatae id dolorem nesciunt voluptatem. Consequatur et tenetur rerum."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"unde dignissimos soluta",
														"Debitis laborum consequuntur quis ipsum iste.",
														"Nisi consequuntur deserunt commodi quia. Sed nesciunt aut.",
														"Ut reprehenderit cum quia non. Deleniti provident magni animi laboriosam veniam corrupti ut magni. Nam mollitia suscipit. Qui cum quis laudantium doloribus saepe id corporis fugit."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"eos quibusdam corporis",
														"Eum sapiente est numquam doloribus.",
														"Optio corporis labore dolore nam magnam nostrum ut ratione rem. Eaque est iste illum nobis quis non. Ipsam voluptate ut tenetur reiciendis dignissimos. Excepturi hic ratione saepe non ut perspiciatis.",
														"Impedit in rerum distinctio quaerat quo vero. Exercitationem sit qui minima iste. Quaerat dolores quod totam itaque est libero ea error. Esse quae fuga nostrum eum."
													]
												}
											],
											[
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"12.40",
														"2012-02-02T06:00:00Z",
														"Walker, Hansen and Deckow",
														"Credit Card Account 5193",
														"payment",
														"37266237"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"300.24",
														"2012-02-02T06:00:00Z",
														"Blick, Abshire and Hickle",
														"Savings Account 0867",
														"payment",
														"62458571"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"16.22",
														"2012-02-02T06:00:00Z",
														"Murphy, Monahan and Kihn",
														"Credit Card Account 3409",
														"invoice",
														"33307585"
													]
												}
											],
											"2d43ffe0-5c21-47e8-8211-2616cad31800",
											"\"4900a19d-0000-0100-0000-5e5017de0000\""
										],
										[
											"o9tdAL4WfHEJAAAAAAAAAA==",
											1582307294,
											"Miss Kristy Morar",
											"Dayne.Quitzon34",
											"Stewart.Little17@yahoo.com",
											{
												"schema": [
													{
														"name": "streetA",
														"nullable": true
													},
													{
														"name": "streetB",
														"nullable": true
													},
													{
														"name": "streetC",
														"nullable": true
													},
													{
														"name": "streetD",
														"nullable": true
													},
													{
														"name": "city",
														"nullable": true
													},
													{
														"name": "state",
														"nullable": true
													},
													{
														"name": "country",
														"nullable": true
													},
													{
														"name": "zipcode",
														"nullable": true
													},
													{
														"name": "geo",
														"dataType": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"nullable": true
													}
												],
												"values": [
													"Major Fort",
													"23991 Kuhic Burg",
													"56488 Reinger Knoll Apt. 145",
													"Suite 939",
													"Kuhicstad",
													"Hawaii",
													"Denmark",
													"00513",
													{
														"schema": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"values": [
															"-4.0130",
															"116.2772"
														]
													}
												]
											},
											"1-320-766-5988 x508",
											"jack.net",
											{
												"schema": [
													{
														"name": "name",
														"nullable": true
													},
													{
														"name": "catchPhrase",
														"nullable": true
													},
													{
														"name": "bs",
														"nullable": true
													}
												],
												"values": [
													"Reynolds Inc",
													"Cloned actuating monitoring",
													"plug-and-play synthesize web services"
												]
											},
											[
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"possimus commodi amet",
														"Dolorem debitis id eveniet aut et distinctio nesciunt.",
														"Sint et aperiam nulla nihil quo. Et perspiciatis quo. Similique facere ut et rerum. Ad quos doloribus ratione suscipit facilis assumenda facere.",
														"Magni vero fuga ex itaque autem laudantium. Vitae cupiditate non. Consequatur alias tempore expedita eum. Quibusdam qui dolor sit sint fuga error perspiciatis libero."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"et sequi rerum",
														"Dolor earum mollitia.",
														"Adipisci eveniet vitae. Accusamus ab ut maxime sunt enim. Minima qui vero explicabo. Amet nam quibusdam esse impedit velit tempora qui quis eum. Quis accusantium inventore quia sequi rerum est.",
														"Placeat qui dolorem dolore sint itaque aliquid quia. Excepturi amet placeat repudiandae deleniti expedita. Molestiae sit placeat. Dolor ipsa libero dolores aut. Sunt rerum laborum cupiditate temporibus."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"et minima odio",
														"Explicabo sit iure excepturi perferendis quae illo consequuntur a.",
														"Et sunt est molestiae eos. Pariatur quia perspiciatis itaque illum deleniti laboriosam ea libero. Illo ratione sunt deserunt non ab aperiam qui ut impedit. Doloremque pariatur et illo esse. Dolorum qui est. Eligendi eos magni dolores sed ratione sit tempora.",
														"Enim praesentium laborum eligendi cumque error eum sit error nihil. Consequatur consectetur quibusdam beatae magni deleniti labore cum consequatur similique. Qui in sequi sint ut natus nemo. Excepturi recusandae quo ut tenetur rerum. Iusto doloribus totam. Cum repellat commodi quo libero mollitia earum architecto culpa."
													]
												}
											],
											[
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"886.87",
														"2012-02-02T06:00:00Z",
														"Heathcote and Sons",
														"Auto Loan Account 2241",
														"deposit",
														"55402733"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"877.45",
														"2012-02-02T06:00:00Z",
														"Murphy LLC",
														"Credit Card Account 5085",
														"deposit",
														"51731576"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"562.38",
														"2012-02-02T06:00:00Z",
														"Shields and Sons",
														"Savings Account 6181",
														"deposit",
														"44589641"
													]
												}
											],
											"a3e45cd7-f0aa-4600-a9b5-6219f83b4017",
											"\"4900a29d-0000-0100-0000-5e5017de0000\""
										],
										[
											"o9tdAL4WfHEKAAAAAAAAAA==",
											1582307294,
											"Bud Reilly",
											"Makenzie44",
											"Arne_Aufderhar43@yahoo.com",
											{
												"schema": [
													{
														"name": "streetA",
														"nullable": true
													},
													{
														"name": "streetB",
														"nullable": true
													},
													{
														"name": "streetC",
														"nullable": true
													},
													{
														"name": "streetD",
														"nullable": true
													},
													{
														"name": "city",
														"nullable": true
													},
													{
														"name": "state",
														"nullable": true
													},
													{
														"name": "country",
														"nullable": true
													},
													{
														"name": "zipcode",
														"nullable": true
													},
													{
														"name": "geo",
														"dataType": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"nullable": true
													}
												],
												"values": [
													"Alexie Cliff",
													"5464 Ava Pines",
													"12665 Janice Stravenue Apt. 941",
													"Apt. 261",
													"East Leonoramouth",
													"Illinois",
													"Burkina Faso",
													"62981",
													{
														"schema": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"values": [
															"3.8307",
															"-43.1132"
														]
													}
												]
											},
											"217.918.0206 x0478",
											"arely.com",
											{
												"schema": [
													{
														"name": "name",
														"nullable": true
													},
													{
														"name": "catchPhrase",
														"nullable": true
													},
													{
														"name": "bs",
														"nullable": true
													}
												],
												"values": [
													"Watsica, Zemlak and Nitzsche",
													"Balanced analyzing policy",
													"scalable expedite content"
												]
											},
											[
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"qui qui doloribus",
														"Ex molestias ea molestiae qui excepturi qui maiores.",
														"Aut aliquid est asperiores ut iure nostrum qui asperiores. Doloremque maiores error eaque ut eveniet similique dolorem. Ipsam qui explicabo perferendis explicabo. Quaerat aut totam dicta totam ut consequatur repellendus itaque. Nihil ullam voluptatem eaque praesentium dolorem dicta.",
														"Totam ab nisi sit nobis totam quis eos. Non explicabo autem quam illum ut totam. Minus ab soluta saepe maxime. Ut voluptate amet ut nihil. Voluptatem ipsa maxime et."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"commodi et eos",
														"Aliquid omnis asperiores dolorem distinctio voluptatem dolorem a.",
														"Quaerat distinctio dolorem. Ut est qui omnis nostrum sed rem. Et praesentium sunt amet fuga commodi aliquam autem voluptates quod. Quibusdam non perferendis facilis odit molestiae officia eum.",
														"Et nobis tempore reprehenderit dolorum qui autem inventore. Ab qui dolor est inventore quidem animi quae. Quis harum ea perspiciatis fugiat ut placeat quia sit ut. Illum animi laboriosam voluptatibus."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"sed quia odio",
														"Suscipit labore earum minima magni accusantium et.",
														"Necessitatibus enim voluptas maiores aspernatur sint. Tempore est consequuntur deserunt omnis occaecati perferendis voluptates. Quas enim excepturi quisquam repellendus hic possimus quam a. Fuga blanditiis porro est nisi ipsa ratione est delectus. Est voluptate quae sapiente nulla similique officia atque voluptatem possimus.",
														"Nemo nisi soluta consequatur et eaque impedit eveniet. Et fuga natus cupiditate quo quisquam laudantium voluptatum. Ut consequatur delectus rem in numquam omnis blanditiis enim."
													]
												}
											],
											[
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"533.55",
														"2012-02-02T06:00:00Z",
														"Bosco - Lebsack",
														"Personal Loan Account 9457",
														"deposit",
														"98108779"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"99.42",
														"2012-02-02T06:00:00Z",
														"Heaney Inc",
														"Credit Card Account 8115",
														"withdrawal",
														"91604810"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"802.40",
														"2012-02-02T06:00:00Z",
														"Ondricka and Sons",
														"Investment Account 1659",
														"withdrawal",
														"64273944"
													]
												}
											],
											"2fb72289-203f-4af8-ab90-c831ea28bfbe",
											"\"4900a39d-0000-0100-0000-5e5017de0000\""
										],
										[
											"o9tdAL4WfHELAAAAAAAAAA==",
											1582307294,
											"Mr. Donna Schulist",
											"Columbus17",
											"Collin_Klein69@gmail.com",
											{
												"schema": [
													{
														"name": "streetA",
														"nullable": true
													},
													{
														"name": "streetB",
														"nullable": true
													},
													{
														"name": "streetC",
														"nullable": true
													},
													{
														"name": "streetD",
														"nullable": true
													},
													{
														"name": "city",
														"nullable": true
													},
													{
														"name": "state",
														"nullable": true
													},
													{
														"name": "country",
														"nullable": true
													},
													{
														"name": "zipcode",
														"nullable": true
													},
													{
														"name": "geo",
														"dataType": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"nullable": true
													}
												],
												"values": [
													"Stiedemann Shore",
													"1427 Nathen Meadow",
													"2082 Nakia Brooks Apt. 297",
													"Suite 972",
													"North Ernie",
													"Rhode Island",
													"Antarctica (the territory South of 60 deg S)",
													"74877-0697",
													{
														"schema": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"values": [
															"-50.2651",
															"-139.8912"
														]
													}
												]
											},
											"1-124-398-5659",
											"marie.net",
											{
												"schema": [
													{
														"name": "name",
														"nullable": true
													},
													{
														"name": "catchPhrase",
														"nullable": true
													},
													{
														"name": "bs",
														"nullable": true
													}
												],
												"values": [
													"Hauck, Klein and Kunde",
													"Object-based secondary migration",
													"bleeding-edge generate networks"
												]
											},
											[
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"ducimus sit amet",
														"Ad eos optio iusto perspiciatis.",
														"Ullam error aliquid cupiditate ut enim delectus modi nobis autem. Eum dolorum blanditiis in quae ipsa est et. Et minima eos aut explicabo repellendus eligendi voluptatem quo. Assumenda aut fugit perspiciatis. Vel nihil quam in exercitationem assumenda nulla.",
														"Deserunt velit enim soluta quis qui. Quia eligendi eaque veritatis maxime odit nobis deserunt reiciendis quaerat. Accusamus minima non saepe delectus. Qui omnis rem non inventore. Aut ut voluptates nesciunt ut et. Eum ut dolorem harum officiis animi et sed."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"rerum quam nam",
														"Harum doloremque omnis qui et.",
														"Corrupti fugiat neque perferendis omnis maiores. Nihil et soluta qui dolor enim doloremque quibusdam. Voluptatem deleniti voluptates. Nobis autem sit. Itaque neque ipsam neque voluptatum dolor modi. Consequatur ea ad ad atque voluptatibus praesentium quae consectetur.",
														"Ea ab blanditiis iure numquam ut. Facilis ea culpa et provident facere optio rerum. Autem nostrum nesciunt saepe autem et iusto et omnis omnis. Consequatur quis occaecati rerum nam tempore rem omnis quo aut. Fugiat eos id ut quaerat itaque maxime similique. Maiores voluptas minus explicabo adipisci inventore voluptas."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"occaecati ipsam reprehenderit",
														"Corporis atque amet reprehenderit accusantium optio nihil consequatur.",
														"Sint vel nam. Quis ullam iusto in quod aperiam in ut et. Voluptas accusantium beatae dolorum quia. Qui blanditiis et numquam doloribus dolorem. Voluptatem dolor nostrum ullam ut doloribus.",
														"Accusantium molestiae dolor modi ab. Facilis maiores eaque aperiam tempore. Alias officia id dicta."
													]
												}
											],
											[
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"570.16",
														"2012-02-02T06:00:00Z",
														"Kerluke and Sons",
														"Money Market Account 9806",
														"invoice",
														"20090939"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"740.25",
														"2012-02-02T06:00:00Z",
														"Christiansen Group",
														"Credit Card Account 1649",
														"payment",
														"63026960"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"934.61",
														"2012-02-02T06:00:00Z",
														"Leannon Group",
														"Checking Account 7266",
														"invoice",
														"38936695"
													]
												}
											],
											"6f0c7dcf-2afd-4fa8-8f57-bcac1ea63d1f",
											"\"4900a49d-0000-0100-0000-5e5017de0000\""
										],
										[
											"o9tdAL4WfHEMAAAAAAAAAA==",
											1582307294,
											"Mrs. Aracely McCullough",
											"Daron_Rosenbaum73",
											"Daphnee.Morar76@hotmail.com",
											{
												"schema": [
													{
														"name": "streetA",
														"nullable": true
													},
													{
														"name": "streetB",
														"nullable": true
													},
													{
														"name": "streetC",
														"nullable": true
													},
													{
														"name": "streetD",
														"nullable": true
													},
													{
														"name": "city",
														"nullable": true
													},
													{
														"name": "state",
														"nullable": true
													},
													{
														"name": "country",
														"nullable": true
													},
													{
														"name": "zipcode",
														"nullable": true
													},
													{
														"name": "geo",
														"dataType": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"nullable": true
													}
												],
												"values": [
													"Metz Stravenue",
													"2549 Mckenna Lane",
													"10808 Jeffery Rue Apt. 920",
													"Suite 638",
													"New Janickberg",
													"Alaska",
													"Japan",
													"85419",
													{
														"schema": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"values": [
															"-27.5246",
															"-49.6258"
														]
													}
												]
											},
											"(951) 837-3822 x995",
											"reid.com",
											{
												"schema": [
													{
														"name": "name",
														"nullable": true
													},
													{
														"name": "catchPhrase",
														"nullable": true
													},
													{
														"name": "bs",
														"nullable": true
													}
												],
												"values": [
													"Koss, Fahey and Glover",
													"Ergonomic non-volatile customer loyalty",
													"sticky matrix networks"
												]
											},
											[
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"rerum fuga pariatur",
														"Voluptas doloribus expedita eos ratione rerum nulla.",
														"Beatae deleniti est. Sapiente eos ad quasi nobis. Et odit odit pariatur. Quia dolores nostrum quo. Est et est neque exercitationem et quaerat itaque quidem. Ducimus ducimus quisquam.",
														"Neque optio odit voluptatem doloremque consequuntur quas temporibus. Expedita accusamus minima perferendis expedita. Doloremque hic sit magnam nostrum quaerat. Tempora optio sunt adipisci assumenda vero maxime fugiat corporis. Et dolorum laboriosam tempora. Ipsum et blanditiis voluptatum ex accusantium in."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"iure praesentium consectetur",
														"Corrupti rerum quos aperiam veniam ducimus beatae rem.",
														"Aliquid nam consequatur commodi laboriosam ratione atque quod in dolore. Vel excepturi est dolorem laboriosam dicta cumque perferendis. Et eveniet qui dicta nesciunt est laborum.",
														"Pariatur consequatur sapiente sunt sunt est sapiente sit quibusdam nisi. Ipsum magnam blanditiis dolore. Iure qui maxime nihil."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"maiores commodi numquam",
														"Soluta rerum nostrum tempore aliquam consequatur.",
														"Magni iste rerum expedita dolor. Fugit assumenda voluptatibus. Rerum provident unde velit et vel commodi.",
														"Sunt aliquam veritatis error rerum voluptas. Nobis eos id sunt deserunt voluptate repudiandae enim sit vitae. Qui voluptas voluptas mollitia sint et dolore."
													]
												}
											],
											[
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"764.07",
														"2012-02-02T06:00:00Z",
														"Murphy Inc",
														"Personal Loan Account 4413",
														"deposit",
														"71685060"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"427.36",
														"2012-02-02T06:00:00Z",
														"Braun - Bradtke",
														"Checking Account 8921",
														"deposit",
														"33789939"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"736.58",
														"2012-02-02T06:00:00Z",
														"Dietrich - Casper",
														"Auto Loan Account 3973",
														"payment",
														"47930479"
													]
												}
											],
											"e84a297c-41a1-4eb8-9eb0-b290d2850f7a",
											"\"4900a59d-0000-0100-0000-5e5017de0000\""
										],
										[
											"o9tdAL4WfHENAAAAAAAAAA==",
											1582307294,
											"Adriel Stamm IV",
											"Ahmed.Adams",
											"Zaria_DuBuque45@hotmail.com",
											{
												"schema": [
													{
														"name": "streetA",
														"nullable": true
													},
													{
														"name": "streetB",
														"nullable": true
													},
													{
														"name": "streetC",
														"nullable": true
													},
													{
														"name": "streetD",
														"nullable": true
													},
													{
														"name": "city",
														"nullable": true
													},
													{
														"name": "state",
														"nullable": true
													},
													{
														"name": "country",
														"nullable": true
													},
													{
														"name": "zipcode",
														"nullable": true
													},
													{
														"name": "geo",
														"dataType": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"nullable": true
													}
												],
												"values": [
													"Osinski Dale",
													"05058 Wilhelm Pines",
													"726 Blaise Overpass Suite 342",
													"Suite 129",
													"Dillanville",
													"Arkansas",
													"Moldova",
													"78862",
													{
														"schema": [
															{
																"name": "lat",
																"nullable": true
															},
															{
																"name": "lng",
																"nullable": true
															}
														],
														"values": [
															"10.7978",
															"159.5776"
														]
													}
												]
											},
											"075-655-7393",
											"dandre.net",
											{
												"schema": [
													{
														"name": "name",
														"nullable": true
													},
													{
														"name": "catchPhrase",
														"nullable": true
													},
													{
														"name": "bs",
														"nullable": true
													}
												],
												"values": [
													"Skiles, Kreiger and Jacobson",
													"Focused global forecast",
													"distributed transform infrastructures"
												]
											},
											[
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"incidunt odio amet",
														"Consequatur fugiat alias necessitatibus doloremque quia ducimus tempora.",
														"Nihil excepturi ea illo optio vel sed rerum possimus. Earum similique aut. Et saepe et. Sed sed mollitia non totam aliquam totam quis aliquid iusto. Illum consequatur dolores corporis repellat sint neque. Ipsum accusantium reiciendis in.",
														"Dolor nulla voluptatibus qui. Minus quisquam architecto. Sint dolores culpa voluptatem et optio pariatur sequi nostrum. Tempore reprehenderit ratione aliquid optio. Distinctio ad dolores nesciunt a aliquid natus sequi ipsam."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"aut eum recusandae",
														"Veniam assumenda culpa vero odit.",
														"Molestiae sit voluptatem eum facere ut accusamus magni. Vitae quasi pariatur iusto est nihil quaerat ipsum voluptatem placeat. Neque voluptatem id. Repudiandae beatae commodi.",
														"Suscipit illo suscipit architecto illum voluptatibus. Sit omnis nesciunt laudantium sapiente omnis. Hic in aliquam magni. Totam maxime mollitia officiis nam ullam non magnam vel. Illo quaerat autem autem ea tempora odit. Repellendus nihil libero voluptatem aut vel qui ut quasi."
													]
												},
												{
													"schema": [
														{
															"name": "words",
															"nullable": true
														},
														{
															"name": "sentence",
															"nullable": true
														},
														{
															"name": "sentences",
															"nullable": true
														},
														{
															"name": "paragraph",
															"nullable": true
														}
													],
													"values": [
														"est rerum incidunt",
														"Beatae beatae architecto iusto.",
														"Animi est ut cumque nihil. Aut omnis quasi similique fugiat non officiis. Et tempora qui accusantium mollitia aut. Reprehenderit error labore quia neque.",
														"Amet consequatur non corrupti veritatis est. Ipsum repellat consequuntur. Itaque repellendus sapiente laborum rerum delectus tempore eum iusto sed. Temporibus qui qui odit cupiditate sunt aut nesciunt cum. Perferendis nostrum iure ad ipsum eum est exercitationem nisi cum."
													]
												}
											],
											[
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"470.85",
														"2012-02-02T06:00:00Z",
														"Friesen - Kris",
														"Personal Loan Account 6101",
														"withdrawal",
														"97062153"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"589.03",
														"2012-02-02T06:00:00Z",
														"O'Connell, Crooks and Wunsch",
														"Credit Card Account 7896",
														"withdrawal",
														"93983669"
													]
												},
												{
													"schema": [
														{
															"name": "amount",
															"nullable": true
														},
														{
															"name": "date",
															"nullable": true
														},
														{
															"name": "business",
															"nullable": true
														},
														{
															"name": "name",
															"nullable": true
														},
														{
															"name": "type",
															"nullable": true
														},
														{
															"name": "account",
															"nullable": true
														}
													],
													"values": [
														"973.76",
														"2012-02-02T06:00:00Z",
														"Murphy, Little and Russel",
														"Savings Account 8382",
														"withdrawal",
														"90864486"
													]
												}
											],
											"61807ebb-7971-4b3a-848c-78850c8a867a",
											"\"4900a69d-0000-0100-0000-5e5017de0000\""
										]
									],
									"schema": [
										"_rid",
										"_ts",
										"name",
										"username",
										"email",
										"address",
										"phone",
										"website",
										"company",
										"posts",
										"accountHistory",
										"id",
										"_etag"
									],
									"filter": null
								},
								"isSummary": false,
								"isSql": true
							}
						},
						"source": [
							"%%sql\n",
							"SELECT * FROM democosmosdb limit 10"
						],
						"outputs": [],
						"execution_count": 9
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Flatten Cosmos DB schema\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"from pyspark.sql.functions import col\n",
							"\n",
							"\n",
							"def flatten_df(nested_df):\n",
							"    stack = [((), nested_df)]\n",
							"    columns = []\n",
							"\n",
							"    while len(stack) > 0:\n",
							"        parents, df = stack.pop()\n",
							"\n",
							"        flat_cols = [\n",
							"            col(\".\".join(parents + (c[0],))).alias(\"_\".join(parents + (c[0],)))\n",
							"            for c in df.dtypes\n",
							"            if c[1][:6] != \"struct\"\n",
							"        ]\n",
							"\n",
							"        nested_cols = [\n",
							"            c[0]\n",
							"            for c in df.dtypes\n",
							"            if c[1][:6] == \"struct\"\n",
							"        ]\n",
							"\n",
							"        columns.extend(flat_cols)\n",
							"\n",
							"        for nested_col in nested_cols:\n",
							"            projected_df = df.select(nested_col + \".*\")\n",
							"            stack.append((parents + (nested_col,), projected_df))\n",
							"\n",
							"    return nested_df.select(columns)"
						],
						"outputs": [],
						"execution_count": 10
					},
					{
						"cell_type": "code",
						"source": [
							"from pyspark.sql.types import StringType, StructField, StructType\n",
							"df_retail_data_flat = flatten_df(df_retail_data)"
						],
						"outputs": [],
						"execution_count": 11
					},
					{
						"cell_type": "code",
						"metadata": {
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [
										"_rid"
									],
									"values": [
										"_rid"
									],
									"yLabel": "_rid",
									"xLabel": "_rid",
									"aggregation": "COUNT",
									"aggByBackend": false
								},
								"previewData": {
									"rows": [
										{
											"_rid": "o9tdAL4WfHFwHwEAAAAAAA==",
											"_ts": 1582311782,
											"name": "Ciara Kuvalis",
											"username": "Keyshawn_Steuber79",
											"email": "Maria_Crona81@yahoo.com",
											"phone": "(473) 299-7593",
											"website": "uriah.com",
											"posts": [
												{
													"words": "modi dolores eveniet",
													"sentence": "Sed fuga pariatur et.",
													"sentences": "Eum magnam debitis ut dolorum id aspernatur assumenda. Aut maxime omnis rerum assumenda perspiciatis vitae reprehenderit consequuntur. Laborum nihil nesciunt sed. Labore debitis ut accusantium voluptas sapiente magnam accusantium officiis aut. Consectetur neque et mollitia incidunt magni ipsam enim explicabo aspernatur. Est sequi quam quia ea atque.",
													"paragraph": "In voluptas vel laboriosam nisi adipisci amet. Pariatur repudiandae dolorum similique sed quis consectetur alias placeat. A repellat minus. Voluptatem nobis deserunt ea eum reiciendis doloremque repellat voluptates."
												},
												{
													"words": "laboriosam sapiente molestias",
													"sentence": "Neque vero quia quia et voluptatibus eum magni.",
													"sentences": "Voluptas nobis consequatur dignissimos molestiae excepturi veritatis nemo eaque cum. Asperiores culpa aut laboriosam voluptates aliquid quia. Et iusto autem tempora. Ut inventore consequatur dolore esse aut. Optio quae nostrum beatae odio sint laboriosam consequatur officia. Suscipit provident omnis est culpa velit rem.",
													"paragraph": "Porro impedit cum. Molestiae voluptatibus sit cupiditate. Deleniti sit sed rem. Quia corrupti commodi eius. Consequatur odit culpa consequatur qui temporibus earum est veniam saepe."
												},
												{
													"words": "occaecati iure et",
													"sentence": "Aliquam voluptas voluptas est ab quaerat facere nobis.",
													"sentences": "Et sed porro id iste id iure accusantium expedita. Voluptates sapiente et exercitationem odio.",
													"paragraph": "Dignissimos ducimus odio. Ipsam ea debitis tempora earum suscipit repellat. Id et laboriosam at quod quos omnis. Quae ex commodi quas et a quo veniam fuga architecto. Necessitatibus optio recusandae."
												}
											],
											"accountHistory": [
												{
													"amount": "341.74",
													"date": "2012-02-02T06:00:00Z",
													"business": "Schuppe - Blick",
													"name": "Personal Loan Account 1472",
													"type": "deposit",
													"account": "81114748"
												},
												{
													"amount": "971.51",
													"date": "2012-02-02T06:00:00Z",
													"business": "Senger and Sons",
													"name": "Auto Loan Account 6371",
													"type": "payment",
													"account": "51962855"
												},
												{
													"amount": "479.32",
													"date": "2012-02-02T06:00:00Z",
													"business": "Morissette, Hermann and Stroman",
													"name": "Personal Loan Account 7116",
													"type": "invoice",
													"account": "70819993"
												}
											],
											"id": "831722c4-086c-4bc9-b963-e5eebd739e4c",
											"_etag": "\"4a0039fa-0000-0100-0000-5e5029660000\"",
											"company_name": "Schuppe, Dicki and Romaguera",
											"company_catchPhrase": "Advanced national groupware",
											"company_bs": "out-of-the-box e-enable content",
											"address_streetA": "Maybelle Corners",
											"address_streetB": "665 Austen Hills",
											"address_streetC": "95691 Senger Spur Apt. 467",
											"address_streetD": "Apt. 964",
											"address_city": "Port Rickie",
											"address_state": "Maryland",
											"address_country": "Myanmar",
											"address_zipcode": "12026-9381",
											"address_geo_lat": "10.1084",
											"address_geo_lng": "-66.7566"
										},
										{
											"_rid": "o9tdAL4WfHFxHwEAAAAAAA==",
											"_ts": 1582311782,
											"name": "Kayli Ward",
											"username": "Viviane.Hauck8",
											"email": "Orlo_Hamill@hotmail.com",
											"phone": "(429) 846-9391 x7087",
											"website": "deron.org",
											"posts": [
												{
													"words": "illum enim ab",
													"sentence": "In et sint aliquid tempore quis distinctio fugiat.",
													"sentences": "Ratione amet quibusdam est rem natus fuga dolorem. Recusandae sit tempora nobis nam nesciunt facere dolores ullam ex.",
													"paragraph": "Tenetur iusto ea omnis aut similique rerum ducimus voluptatem. Saepe labore molestiae eum iste eaque. Atque quis maxime enim qui at vero reiciendis asperiores. Rem dignissimos doloribus. Enim est dolore est quaerat est. Sed perspiciatis et sed deleniti nisi sed aut."
												},
												{
													"words": "in numquam dolorem",
													"sentence": "Dolorem cumque voluptate qui corporis et blanditiis quod eveniet.",
													"sentences": "Molestias perspiciatis totam. Rerum consequuntur consectetur accusamus id quia laboriosam ea. Vel ipsa error mollitia minus mollitia saepe sit voluptatem. Cum quibusdam ipsa officia sint. In nesciunt voluptas ipsum ut omnis.",
													"paragraph": "Architecto iste ut totam doloribus. Voluptates animi non voluptas. Maxime dolorem voluptatem. Molestiae doloribus blanditiis. Commodi repudiandae et quidem qui sit. Hic quo cupiditate voluptate porro inventore sint ratione."
												},
												{
													"words": "mollitia ut est",
													"sentence": "Qui porro aut id.",
													"sentences": "Quo suscipit dolorem maxime ducimus. Dolores odit qui esse animi et eaque.",
													"paragraph": "Blanditiis dolores aspernatur. Repudiandae itaque nesciunt iste ipsum aperiam ut labore sequi impedit. Officiis sit voluptatem fugiat ut sit voluptas nihil blanditiis."
												}
											],
											"accountHistory": [
												{
													"amount": "396.34",
													"date": "2012-02-02T06:00:00Z",
													"business": "Treutel Inc",
													"name": "Personal Loan Account 6916",
													"type": "deposit",
													"account": "97666350"
												},
												{
													"amount": "661.78",
													"date": "2012-02-02T06:00:00Z",
													"business": "Grady and Sons",
													"name": "Investment Account 7790",
													"type": "invoice",
													"account": "99723577"
												},
												{
													"amount": "192.47",
													"date": "2012-02-02T06:00:00Z",
													"business": "Reilly, Conroy and Metz",
													"name": "Investment Account 9239",
													"type": "deposit",
													"account": "26774650"
												}
											],
											"id": "51eecf8e-9e09-443d-a150-03b78994c935",
											"_etag": "\"4a003afa-0000-0100-0000-5e5029660000\"",
											"company_name": "Lowe - Blick",
											"company_catchPhrase": "Digitized 6th generation array",
											"company_bs": "viral morph e-commerce",
											"address_streetA": "Howe Mills",
											"address_streetB": "03877 Gleichner Ferry",
											"address_streetC": "37086 Noemy Stream Apt. 482",
											"address_streetD": "Apt. 274",
											"address_city": "Lake Darrion",
											"address_state": "Arkansas",
											"address_country": "Finland",
											"address_zipcode": "10981-3612",
											"address_geo_lat": "30.5565",
											"address_geo_lng": "20.1127"
										},
										{
											"_rid": "o9tdAL4WfHFyHwEAAAAAAA==",
											"_ts": 1582311782,
											"name": "Gillian Howell",
											"username": "Georgianna12",
											"email": "Clemens38@gmail.com",
											"phone": "471-997-5925",
											"website": "bianka.org",
											"posts": [
												{
													"words": "sed vero a",
													"sentence": "Aut facere labore voluptatem nihil iste.",
													"sentences": "Quis eveniet atque qui voluptas aliquam quaerat et odio. Dicta ratione voluptas debitis quam voluptatum provident consectetur repellat. Pariatur aliquam id aut. Veritatis est perspiciatis qui minus sed.",
													"paragraph": "Aut veniam quis illo voluptatum nesciunt rerum. Et vitae magnam in recusandae. Culpa aut sint doloremque dolorem porro dignissimos est nihil."
												},
												{
													"words": "nobis nostrum quia",
													"sentence": "Est exercitationem velit quis nisi odio sunt libero.",
													"sentences": "Quia aperiam earum mollitia ad ut. Esse sit explicabo dolor maxime optio. Unde distinctio dolor. Est explicabo cumque unde reiciendis. Voluptatem consequuntur quo molestiae dicta temporibus molestiae esse enim.",
													"paragraph": "Quasi maxime molestias facilis est animi qui quia qui odio. Iusto maiores eaque illo quis. Reprehenderit qui delectus aut natus a optio accusamus et deserunt. Aliquid ipsa dignissimos ut nobis et cum. Recusandae veritatis hic. Quis architecto cumque maiores nemo aspernatur."
												},
												{
													"words": "rerum sit qui",
													"sentence": "Eaque in possimus ex.",
													"sentences": "Impedit illum consequatur doloremque et repellendus nam quam sit. Laborum dolorem voluptas minima incidunt et. Quos aliquam vitae labore sapiente laudantium. Molestiae vero consequatur quis dolor nemo corporis qui quod id. Perspiciatis ut et in dolore eveniet totam quia omnis.",
													"paragraph": "Voluptatem error quo. Sit soluta veniam qui similique laboriosam ratione a deserunt ut. Aut corporis maiores tempora ad est nihil. Sit quas omnis dolorum pariatur. Non veritatis laboriosam corrupti nemo corrupti fugiat aspernatur quia dolorem. Iusto nemo ipsa."
												}
											],
											"accountHistory": [
												{
													"amount": "348.20",
													"date": "2012-02-02T06:00:00Z",
													"business": "Wintheiser Inc",
													"name": "Money Market Account 4008",
													"type": "withdrawal",
													"account": "85635746"
												},
												{
													"amount": "184.66",
													"date": "2012-02-02T06:00:00Z",
													"business": "Schuster - Douglas",
													"name": "Checking Account 6848",
													"type": "withdrawal",
													"account": "87720375"
												},
												{
													"amount": "575.63",
													"date": "2012-02-02T06:00:00Z",
													"business": "Block - DuBuque",
													"name": "Home Loan Account 2093",
													"type": "deposit",
													"account": "56180875"
												}
											],
											"id": "c08a9502-7781-439a-9ab6-3710ca4b81b6",
											"_etag": "\"4a003bfa-0000-0100-0000-5e5029660000\"",
											"company_name": "Kuhn Group",
											"company_catchPhrase": "Monitored transitional structure",
											"company_bs": "front-end visualize vortals",
											"address_streetA": "Feeney Villages",
											"address_streetB": "6497 Velma Shore",
											"address_streetC": "33493 Linnea Keys Suite 288",
											"address_streetD": "Suite 558",
											"address_city": "Gerlachton",
											"address_state": "Colorado",
											"address_country": "Czech Republic",
											"address_zipcode": "25748-5351",
											"address_geo_lat": "84.1010",
											"address_geo_lng": "-100.9339"
										},
										{
											"_rid": "o9tdAL4WfHFzHwEAAAAAAA==",
											"_ts": 1582311782,
											"name": "Dolores Vandervort",
											"username": "Elroy88",
											"email": "Olen14@hotmail.com",
											"phone": "1-529-420-1331",
											"website": "mina.org",
											"posts": [
												{
													"words": "aut aut id",
													"sentence": "Numquam beatae dolorum voluptates quisquam atque temporibus velit.",
													"sentences": "Et eveniet sed. Iusto quasi et corporis odio culpa quasi nisi. Rerum dolorem harum pariatur eum omnis aspernatur nobis consequatur.",
													"paragraph": "Est et dolores aperiam doloremque aperiam inventore. Provident velit consectetur in vitae expedita facere natus accusamus architecto. Rem minus accusantium eum et laboriosam. Non perferendis sequi ipsa velit dolorem."
												},
												{
													"words": "cupiditate quia sunt",
													"sentence": "Voluptatem ullam eos.",
													"sentences": "Deleniti optio accusamus non at. Possimus a quia. Reprehenderit est consequatur accusamus nesciunt ea est sed odio.",
													"paragraph": "Est minima voluptatum voluptatem et et iusto accusamus vitae. Rerum eum omnis odit non minima voluptatem dicta velit. Iure molestiae sed. Nulla maxime ea unde non iste numquam enim."
												},
												{
													"words": "et recusandae expedita",
													"sentence": "Illo deserunt reprehenderit adipisci vitae.",
													"sentences": "Cupiditate omnis aut blanditiis aspernatur nemo impedit pariatur voluptas totam. Beatae autem aperiam cum perspiciatis non ut. Nihil nihil ab voluptatem quisquam saepe eum aut quis. Cupiditate totam quaerat consequatur reprehenderit harum ea voluptatum cupiditate.",
													"paragraph": "Et tempora mollitia in qui autem. Velit sint ab consequatur consequatur consequatur autem id aut reiciendis. Magni est a doloremque veniam eligendi nam. Sed doloremque qui sed. Similique aliquam nobis totam nobis nemo magnam labore autem."
												}
											],
											"accountHistory": [
												{
													"amount": "750.23",
													"date": "2012-02-02T06:00:00Z",
													"business": "Block, Muller and Rosenbaum",
													"name": "Savings Account 7196",
													"type": "payment",
													"account": "69005749"
												},
												{
													"amount": "775.40",
													"date": "2012-02-02T06:00:00Z",
													"business": "Paucek and Sons",
													"name": "Savings Account 2812",
													"type": "invoice",
													"account": "93030659"
												},
												{
													"amount": "291.56",
													"date": "2012-02-02T06:00:00Z",
													"business": "Kozey - Wuckert",
													"name": "Credit Card Account 4649",
													"type": "withdrawal",
													"account": "36286470"
												}
											],
											"id": "79b784f4-f72c-4acf-9de5-7c229b888538",
											"_etag": "\"4a003cfa-0000-0100-0000-5e5029660000\"",
											"company_name": "Hartmann Group",
											"company_catchPhrase": "Reactive optimizing migration",
											"company_bs": "sexy deliver web-readiness",
											"address_streetA": "Bayer Glens",
											"address_streetB": "815 Schimmel Union",
											"address_streetC": "5686 Chloe Orchard Suite 868",
											"address_streetD": "Suite 153",
											"address_city": "North Theo",
											"address_state": "Pennsylvania",
											"address_country": "India",
											"address_zipcode": "15671-4612",
											"address_geo_lat": "65.9521",
											"address_geo_lng": "12.0623"
										},
										{
											"_rid": "o9tdAL4WfHF0HwEAAAAAAA==",
											"_ts": 1582311782,
											"name": "Rowland Pacocha II",
											"username": "Bonnie.Wisoky",
											"email": "Ibrahim53@hotmail.com",
											"phone": "1-055-635-9275 x1951",
											"website": "lonnie.biz",
											"posts": [
												{
													"words": "ut aut et",
													"sentence": "Ratione qui est.",
													"sentences": "Ut saepe officia excepturi non minima labore assumenda minima. Vero iure dolorem id ut reprehenderit. Distinctio velit voluptas cum autem.",
													"paragraph": "Quaerat necessitatibus accusantium. Omnis et a officiis velit quis perspiciatis est. Ut natus eaque fuga."
												},
												{
													"words": "sapiente beatae dolor",
													"sentence": "Reiciendis facere ducimus maxime qui dolor doloremque.",
													"sentences": "Id ad perferendis et fugiat aperiam magnam maiores non repellat. Nisi earum fugit repudiandae ut eaque animi.",
													"paragraph": "Unde perferendis sapiente voluptatem delectus. Facere nulla sint perspiciatis ipsa commodi a consequatur. Magni nesciunt et esse ea velit facilis. Quos molestias est dolor."
												},
												{
													"words": "aperiam eveniet et",
													"sentence": "Totam sapiente iure dolorem quae.",
													"sentences": "Numquam quo ipsam at. Molestiae assumenda architecto quis. Accusantium et dolore possimus est qui. Provident maxime itaque ipsa est. Omnis illum facere omnis quidem vitae voluptas consequatur tempora. Aperiam ut quos quo vel.",
													"paragraph": "Maiores nihil maxime. Voluptatibus debitis accusantium voluptas rerum dolorum aut qui laudantium doloremque. Suscipit eveniet et eos modi eum. Voluptas et suscipit magni qui incidunt asperiores veritatis amet. Nobis voluptatibus illo. Commodi earum autem voluptates aliquam accusamus qui laboriosam voluptas consequuntur."
												}
											],
											"accountHistory": [
												{
													"amount": "383.89",
													"date": "2012-02-02T06:00:00Z",
													"business": "Block, Rippin and Schulist",
													"name": "Personal Loan Account 6445",
													"type": "deposit",
													"account": "16838971"
												},
												{
													"amount": "501.46",
													"date": "2012-02-02T06:00:00Z",
													"business": "Gutkowski, Okuneva and Wolf",
													"name": "Auto Loan Account 1527",
													"type": "invoice",
													"account": "02573115"
												},
												{
													"amount": "709.42",
													"date": "2012-02-02T06:00:00Z",
													"business": "Hintz, Ziemann and Schiller",
													"name": "Auto Loan Account 4002",
													"type": "payment",
													"account": "85516964"
												}
											],
											"id": "b28c0cde-98fd-4657-8b78-0c2f34309dc4",
											"_etag": "\"4a003dfa-0000-0100-0000-5e5029660000\"",
											"company_name": "Jaskolski - Rice",
											"company_catchPhrase": "Assimilated foreground Graphical User Interface",
											"company_bs": "seamless engage interfaces",
											"address_streetA": "Collins Place",
											"address_streetB": "983 Skiles Drives",
											"address_streetC": "8746 Hirthe Passage Suite 258",
											"address_streetD": "Apt. 545",
											"address_city": "Dibbertmouth",
											"address_state": "Arkansas",
											"address_country": "Singapore",
											"address_zipcode": "81494-5503",
											"address_geo_lat": "-6.7281",
											"address_geo_lng": "155.3389"
										},
										{
											"_rid": "o9tdAL4WfHF1HwEAAAAAAA==",
											"_ts": 1582311782,
											"name": "John Prosacco",
											"username": "Oswaldo13",
											"email": "Kathleen_Bogisich85@hotmail.com",
											"phone": "318.227.7567 x4026",
											"website": "nakia.info",
											"posts": [
												{
													"words": "quia eius dicta",
													"sentence": "Voluptatibus minima recusandae iste vero.",
													"sentences": "Unde eligendi iste. Officia sunt maxime autem qui ut reiciendis ut. Quis ipsum reprehenderit consequuntur vel in illum.",
													"paragraph": "Alias aut vero distinctio non. Odit quisquam quam voluptatem placeat. Deleniti eos blanditiis nostrum non consequatur quibusdam. Explicabo quasi sit omnis consequuntur sed. Distinctio explicabo sit sed ut."
												},
												{
													"words": "nam provident molestias",
													"sentence": "Reiciendis velit placeat ea et et minima quisquam.",
													"sentences": "Ratione amet dolore et ad. Non qui quia saepe. Aut nostrum dolor quae nobis labore occaecati qui.",
													"paragraph": "Molestiae odio vero et unde expedita. Possimus at sit. Ad sint amet voluptatem dolor qui maxime vitae eos."
												},
												{
													"words": "reprehenderit quae non",
													"sentence": "Eveniet laboriosam qui.",
													"sentences": "Consequuntur sunt non molestiae magni. Facere aut asperiores et quisquam natus. Ipsa quo facere.",
													"paragraph": "Nesciunt nulla facere vel est explicabo enim est. Ipsam dicta soluta quam quis aut necessitatibus in aut. Ut adipisci ab aperiam in in dolore at quo molestiae."
												}
											],
											"accountHistory": [
												{
													"amount": "370.77",
													"date": "2012-02-02T06:00:00Z",
													"business": "Mosciski Group",
													"name": "Personal Loan Account 8579",
													"type": "withdrawal",
													"account": "23842518"
												},
												{
													"amount": "74.11",
													"date": "2012-02-02T06:00:00Z",
													"business": "Runolfsdottir - Romaguera",
													"name": "Home Loan Account 9424",
													"type": "payment",
													"account": "00448005"
												},
												{
													"amount": "360.56",
													"date": "2012-02-02T06:00:00Z",
													"business": "Hane and Sons",
													"name": "Personal Loan Account 1825",
													"type": "withdrawal",
													"account": "01376550"
												}
											],
											"id": "6efe898e-254f-426f-91cf-d50516c1323b",
											"_etag": "\"4a003efa-0000-0100-0000-5e5029660000\"",
											"company_name": "Sanford - Rippin",
											"company_catchPhrase": "Assimilated bifurcated encryption",
											"company_bs": "integrated exploit bandwidth",
											"address_streetA": "Stone Mountains",
											"address_streetB": "6450 Barrows Station",
											"address_streetC": "576 Dicki Circles Apt. 683",
											"address_streetD": "Apt. 354",
											"address_city": "Velmaberg",
											"address_state": "Michigan",
											"address_country": "Mali",
											"address_zipcode": "85553-9893",
											"address_geo_lat": "51.2581",
											"address_geo_lng": "-94.8897"
										},
										{
											"_rid": "o9tdAL4WfHF2HwEAAAAAAA==",
											"_ts": 1582311782,
											"name": "Evert Huels DDS",
											"username": "Juliet.Hudson",
											"email": "Mekhi.Murazik@hotmail.com",
											"phone": "(976) 982-9877 x591",
											"website": "joesph.biz",
											"posts": [
												{
													"words": "laudantium blanditiis facere",
													"sentence": "Quisquam inventore alias velit.",
													"sentences": "Est molestiae debitis modi. Id fugit cum quaerat eaque qui aperiam doloremque dolor similique.",
													"paragraph": "Dignissimos in aperiam nulla. Nostrum qui sit ea quae incidunt culpa autem officiis voluptatem. Earum quaerat sunt aliquid eos quia sed cum est unde."
												},
												{
													"words": "autem voluptates tempore",
													"sentence": "Maiores rem autem quae accusamus.",
													"sentences": "Est rerum voluptatibus reiciendis est qui consequuntur voluptatem illo harum. Quae praesentium qui magni laborum et non voluptatum recusandae officia. Magnam quia numquam. Ab sunt dolor dolorum cupiditate consequuntur eveniet delectus. Dolorem quia rem quaerat nisi in in voluptatem quasi.",
													"paragraph": "Esse necessitatibus voluptatem iste alias nihil ipsa aspernatur cumque. Illo repellat aut et nemo quae omnis sapiente aspernatur numquam. Enim similique saepe perspiciatis aut a blanditiis doloribus illo possimus. Sint ullam corrupti debitis impedit et quisquam atque voluptates quasi."
												},
												{
													"words": "nihil occaecati adipisci",
													"sentence": "Ea reiciendis vitae.",
													"sentences": "Quasi incidunt odio culpa reiciendis. Facilis nam qui est sequi quis.",
													"paragraph": "Fugit rerum omnis distinctio. Ab totam saepe eos quis eius dolor velit unde consequatur. Aut ut omnis autem quo. Sunt dolor neque voluptates et velit eius id pariatur aut."
												}
											],
											"accountHistory": [
												{
													"amount": "395.50",
													"date": "2012-02-02T06:00:00Z",
													"business": "Wolf and Sons",
													"name": "Money Market Account 4476",
													"type": "invoice",
													"account": "35924870"
												},
												{
													"amount": "774.12",
													"date": "2012-02-02T06:00:00Z",
													"business": "Feil - Larson",
													"name": "Money Market Account 4423",
													"type": "invoice",
													"account": "25845024"
												},
												{
													"amount": "566.03",
													"date": "2012-02-02T06:00:00Z",
													"business": "Hansen Group",
													"name": "Investment Account 5091",
													"type": "withdrawal",
													"account": "45214132"
												}
											],
											"id": "94a0c973-7fcc-497f-8b8c-29b89fcc27d2",
											"_etag": "\"4a003ffa-0000-0100-0000-5e5029660000\"",
											"company_name": "Ullrich and Sons",
											"company_catchPhrase": "Programmable object-oriented knowledge base",
											"company_bs": "web-enabled reintermediate e-tailers",
											"address_streetA": "Swaniawski Loaf",
											"address_streetB": "116 Cleo Street",
											"address_streetC": "7507 Cornelius Shoals Suite 819",
											"address_streetD": "Apt. 329",
											"address_city": "West Terrystad",
											"address_state": "Wisconsin",
											"address_country": "Chile",
											"address_zipcode": "25444",
											"address_geo_lat": "-72.0836",
											"address_geo_lng": "65.4949"
										},
										{
											"_rid": "o9tdAL4WfHF3HwEAAAAAAA==",
											"_ts": 1582311782,
											"name": "Julia Blick",
											"username": "Oda_Spinka48",
											"email": "Crawford18@hotmail.com",
											"phone": "(171) 753-3878",
											"website": "nicolette.org",
											"posts": [
												{
													"words": "hic deserunt eos",
													"sentence": "Adipisci voluptate qui aut vel eligendi sed.",
													"sentences": "Eos eaque perferendis dolor quae eos et eos qui perspiciatis. Architecto velit ea voluptas delectus architecto. Praesentium necessitatibus dolores recusandae. Consectetur itaque vel cumque reprehenderit.",
													"paragraph": "Facere assumenda eaque. Officiis rerum quibusdam et omnis sint ullam. Quod voluptas est assumenda unde quia quis ducimus minima. Dignissimos fuga minima nulla. Rerum voluptatem et et earum est dolore consectetur."
												},
												{
													"words": "minus iusto eum",
													"sentence": "Qui sunt qui aspernatur.",
													"sentences": "Eaque ut et odit natus sit adipisci dolores dolorum porro. Sit asperiores vitae veritatis mollitia culpa sint. Aut quos rem fugit. Qui est nemo eaque suscipit sequi est. Ullam quo omnis maiores molestiae totam temporibus non. Voluptas impedit est labore et suscipit.",
													"paragraph": "Voluptas saepe perspiciatis explicabo quae ratione cupiditate. Pariatur iure dignissimos molestiae voluptatem qui voluptatum distinctio. Non unde inventore laboriosam necessitatibus sunt temporibus eaque repellat vitae. Laborum quibusdam adipisci corrupti minus natus delectus."
												},
												{
													"words": "similique voluptatem iusto",
													"sentence": "Et esse iusto natus assumenda deserunt voluptatem ad ipsa.",
													"sentences": "Enim rerum eius nostrum voluptas deserunt voluptatibus debitis. Quis qui voluptates modi. Fuga quae fugit saepe occaecati et tempora in voluptas. Sed non tenetur ut eum non perspiciatis. Qui qui corrupti debitis tempore quidem nobis. Omnis dolor impedit non et veniam distinctio qui voluptatem.",
													"paragraph": "Praesentium corrupti asperiores qui sit eveniet vel. Quasi qui eos sed asperiores maxime et reprehenderit laborum. Fugiat adipisci reprehenderit illo voluptatem delectus libero doloribus vero. Ad eveniet quas rerum consequatur alias autem et. Vel veniam rerum sit fugiat quo in molestiae voluptatem."
												}
											],
											"accountHistory": [
												{
													"amount": "419.76",
													"date": "2012-02-02T06:00:00Z",
													"business": "Mante - Pacocha",
													"name": "Personal Loan Account 6147",
													"type": "invoice",
													"account": "91427002"
												},
												{
													"amount": "757.22",
													"date": "2012-02-02T06:00:00Z",
													"business": "Ruecker Inc",
													"name": "Home Loan Account 1485",
													"type": "withdrawal",
													"account": "71024980"
												},
												{
													"amount": "470.09",
													"date": "2012-02-02T06:00:00Z",
													"business": "Hettinger - Witting",
													"name": "Savings Account 5372",
													"type": "deposit",
													"account": "79849924"
												}
											],
											"id": "9b9b6fec-46f1-4b36-b96d-7eb059ebcb28",
											"_etag": "\"4a0040fa-0000-0100-0000-5e5029660000\"",
											"company_name": "Gottlieb, Doyle and Haag",
											"company_catchPhrase": "Reactive hybrid installation",
											"company_bs": "user-centric integrate experiences",
											"address_streetA": "Parisian Trafficway",
											"address_streetB": "8696 Enola Brooks",
											"address_streetC": "893 Fahey Cove Apt. 218",
											"address_streetD": "Apt. 136",
											"address_city": "Erdmanside",
											"address_state": "North Carolina",
											"address_country": "Faroe Islands",
											"address_zipcode": "49558-6556",
											"address_geo_lat": "-63.1506",
											"address_geo_lng": "-85.0047"
										},
										{
											"_rid": "o9tdAL4WfHF4HwEAAAAAAA==",
											"_ts": 1582311782,
											"name": "Delia Romaguera",
											"username": "Marisa_Senger95",
											"email": "Nova_Wuckert1@hotmail.com",
											"phone": "093.795.4096 x752",
											"website": "michael.com",
											"posts": [
												{
													"words": "modi rerum ab",
													"sentence": "Quis nam accusamus nihil fuga eligendi quis voluptatum voluptatem.",
													"sentences": "Nam ab omnis libero. Culpa perferendis qui dolores quaerat. Sed quia quis et vero quasi doloribus illum omnis iusto. Architecto et modi aliquam quasi autem impedit tempore veritatis dolorem. Minus eius voluptatem aut velit aliquam voluptates. Eligendi nihil ipsam nobis et et quasi.",
													"paragraph": "Est aperiam et dolores commodi maiores quae rerum illum. Ut non dolorem unde molestiae veritatis nemo molestiae recusandae. Voluptatum neque ducimus sunt labore. Voluptatum assumenda repellendus. Reprehenderit non quis quis ex qui magnam a mollitia."
												},
												{
													"words": "esse magni rem",
													"sentence": "Earum dignissimos quia fuga rem vero.",
													"sentences": "Error soluta ut. Cupiditate cupiditate voluptatibus expedita nemo. Necessitatibus error minima dolorum repellendus.",
													"paragraph": "Aliquid minima modi alias corrupti dolore officia sapiente. Est dolor fugiat magnam nihil aperiam vel quasi ratione. Eaque et laboriosam quos quo sed quisquam eos."
												},
												{
													"words": "in vitae ullam",
													"sentence": "Consequatur vero corporis consequatur omnis aut.",
													"sentences": "Ut praesentium delectus quia. Repellat provident ut incidunt sint iure enim asperiores. Voluptas nobis vel ratione animi quis esse et omnis. Modi sunt est voluptatem. Quidem iste temporibus doloribus voluptatem doloribus.",
													"paragraph": "Nisi est magnam nisi dolores exercitationem. Ab dolores rem. Et sit laboriosam rem consequatur illo consequuntur molestiae placeat. Eum iste distinctio quia. Amet quos voluptas nobis qui. Doloribus sint velit harum quas ea alias explicabo qui."
												}
											],
											"accountHistory": [
												{
													"amount": "588.23",
													"date": "2012-02-02T06:00:00Z",
													"business": "Rosenbaum and Sons",
													"name": "Investment Account 4815",
													"type": "payment",
													"account": "72452797"
												},
												{
													"amount": "247.83",
													"date": "2012-02-02T06:00:00Z",
													"business": "Tillman LLC",
													"name": "Checking Account 4615",
													"type": "payment",
													"account": "29884000"
												},
												{
													"amount": "136.10",
													"date": "2012-02-02T06:00:00Z",
													"business": "Wilkinson Group",
													"name": "Savings Account 9462",
													"type": "invoice",
													"account": "47858979"
												}
											],
											"id": "0ca8f0e3-de91-481d-b528-9624d602a102",
											"_etag": "\"4a0041fa-0000-0100-0000-5e5029660000\"",
											"company_name": "Tremblay - Daniel",
											"company_catchPhrase": "Fully-configurable responsive strategy",
											"company_bs": "value-added scale web-readiness",
											"address_streetA": "Rodriguez Islands",
											"address_streetB": "418 Odell Overpass",
											"address_streetC": "47706 Johathan Turnpike Apt. 236",
											"address_streetD": "Apt. 041",
											"address_city": "Port Monahaven",
											"address_state": "Massachusetts",
											"address_country": "Bahamas",
											"address_zipcode": "59423",
											"address_geo_lat": "48.1933",
											"address_geo_lng": "-120.6050"
										},
										{
											"_rid": "o9tdAL4WfHF5HwEAAAAAAA==",
											"_ts": 1582311783,
											"name": "Thad Reynolds",
											"username": "Aniyah.Ritchie",
											"email": "Bradley_Veum@yahoo.com",
											"phone": "579.655.1892",
											"website": "vidal.biz",
											"posts": [
												{
													"words": "fugiat id sit",
													"sentence": "Perspiciatis iure facere fugit sunt qui nihil dignissimos.",
													"sentences": "Possimus vel qui ipsam ex sit nostrum dolores aut commodi. Nesciunt est hic id quae qui numquam iste. Excepturi ea facilis est. Esse et minus ab aut. Laboriosam quos et ipsam quo ut. Assumenda cumque architecto eveniet dolorem facilis earum.",
													"paragraph": "Delectus nostrum est rem dolorem. Sequi vero nam dolore autem officia voluptatibus itaque. Error eos repudiandae tempora id nisi sit cum. At excepturi quas eum incidunt enim maxime ad repellendus. Sequi necessitatibus quibusdam ut rerum odio. Impedit odit voluptates non sed nisi et laudantium."
												},
												{
													"words": "tempore quisquam nihil",
													"sentence": "Ut sapiente qui aliquid repudiandae facilis perspiciatis.",
													"sentences": "Sit sunt dolores at. Iste est minima aliquam. Officiis aut facere.",
													"paragraph": "In non illum suscipit ducimus. Consectetur molestiae ut praesentium sit eligendi perspiciatis quidem provident. Quidem molestiae error maxime ipsa soluta labore quisquam. Quo et ipsum et illo mollitia non iusto excepturi et. Ex voluptas ut iusto."
												},
												{
													"words": "et vitae maxime",
													"sentence": "Facilis non expedita voluptates.",
													"sentences": "Incidunt ab esse optio modi sint maiores est libero. Omnis perferendis soluta pariatur cupiditate. Optio omnis unde omnis officia. Facere aliquam eligendi nam deserunt veritatis tempore commodi. Quo alias maxime recusandae ut est et nemo. Veritatis libero quasi et.",
													"paragraph": "Et consequatur fugit. Eos voluptas illum doloremque omnis numquam quo iure explicabo. Quod et animi magni omnis voluptas animi. Laboriosam nihil ad eius eum cupiditate itaque quibusdam."
												}
											],
											"accountHistory": [
												{
													"amount": "317.49",
													"date": "2012-02-02T06:00:00Z",
													"business": "Hirthe - Dicki",
													"name": "Auto Loan Account 0360",
													"type": "payment",
													"account": "87470199"
												},
												{
													"amount": "162.82",
													"date": "2012-02-02T06:00:00Z",
													"business": "Torp - Harber",
													"name": "Personal Loan Account 1008",
													"type": "deposit",
													"account": "15439825"
												},
												{
													"amount": "815.92",
													"date": "2012-02-02T06:00:00Z",
													"business": "Klocko - Wilderman",
													"name": "Personal Loan Account 3838",
													"type": "deposit",
													"account": "34863367"
												}
											],
											"id": "15d354c7-5940-46ea-a45b-5d1085c38bcf",
											"_etag": "\"4a0042fa-0000-0100-0000-5e5029670000\"",
											"company_name": "Koepp Inc",
											"company_catchPhrase": "Progressive stable infrastructure",
											"company_bs": "mission-critical incentivize functionalities",
											"address_streetA": "Michale Throughway",
											"address_streetB": "07456 Gabriel Points",
											"address_streetC": "45317 Smith Green Apt. 655",
											"address_streetD": "Apt. 750",
											"address_city": "West Jessikahaven",
											"address_state": "Utah",
											"address_country": "Pitcairn Islands",
											"address_zipcode": "11866-1776",
											"address_geo_lat": "-40.1435",
											"address_geo_lng": "-145.1548"
										}
									],
									"schema": {
										"_rid": "string",
										"_ts": "bigint",
										"name": "string",
										"username": "string",
										"email": "string",
										"phone": "string",
										"website": "string",
										"posts": "array<struct<words:string,sentence:string,sentences:string,paragraph:string>>",
										"accountHistory": "array<struct<amount:string,date:string,business:string,name:string,type:string,account:string>>",
										"id": "string",
										"_etag": "string",
										"company_name": "string",
										"company_catchPhrase": "string",
										"company_bs": "string",
										"address_streetA": "string",
										"address_streetB": "string",
										"address_streetC": "string",
										"address_streetD": "string",
										"address_city": "string",
										"address_state": "string",
										"address_country": "string",
										"address_zipcode": "string",
										"address_geo_lat": "string",
										"address_geo_lng": "string"
									},
									"filter": null
								},
								"aggData": {
									"_rid": {
										"o9tdAL4WfHF0HwEAAAAAAA==": 1,
										"o9tdAL4WfHF1HwEAAAAAAA==": 1,
										"o9tdAL4WfHF2HwEAAAAAAA==": 1,
										"o9tdAL4WfHF3HwEAAAAAAA==": 1,
										"o9tdAL4WfHF4HwEAAAAAAA==": 1,
										"o9tdAL4WfHF5HwEAAAAAAA==": 1,
										"o9tdAL4WfHFwHwEAAAAAAA==": 1,
										"o9tdAL4WfHFxHwEAAAAAAA==": 1,
										"o9tdAL4WfHFyHwEAAAAAAA==": 1,
										"o9tdAL4WfHFzHwEAAAAAAA==": 1
									}
								},
								"isSummary": false,
								"isSql": false
							}
						},
						"source": [
							"display(df_retail_data_flat.limit(10))"
						],
						"outputs": [],
						"execution_count": 12
					},
					{
						"cell_type": "code",
						"source": [
							"df_retail_data_flat.printSchema()"
						],
						"outputs": [],
						"execution_count": 13
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Explode and flatten the array\n",
							""
						]
					},
					{
						"cell_type": "code",
						"metadata": {
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [
										"username"
									],
									"values": [
										"username"
									],
									"yLabel": "username",
									"xLabel": "username",
									"aggregation": "COUNT",
									"aggByBackend": false
								},
								"previewData": {
									"rows": [
										{
											"username": "Maurice_Sawayn",
											"email": "Priscilla_Jones@hotmail.com",
											"phone": "1-928-355-8933",
											"website": "faye.org",
											"amount": "107.62",
											"date": "2012-02-02T06:00:00Z",
											"business": "Roob LLC",
											"name": "Home Loan Account 6220",
											"type": "payment",
											"account": "03705510"
										},
										{
											"username": "Maurice_Sawayn",
											"email": "Priscilla_Jones@hotmail.com",
											"phone": "1-928-355-8933",
											"website": "faye.org",
											"amount": "650.88",
											"date": "2012-02-02T06:00:00Z",
											"business": "Kuphal, Lynch and Pouros",
											"name": "Checking Account 9001",
											"type": "payment",
											"account": "85352791"
										},
										{
											"username": "Maurice_Sawayn",
											"email": "Priscilla_Jones@hotmail.com",
											"phone": "1-928-355-8933",
											"website": "faye.org",
											"amount": "878.63",
											"date": "2012-02-02T06:00:00Z",
											"business": "Reynolds Group",
											"name": "Money Market Account 8743",
											"type": "deposit",
											"account": "53230334"
										},
										{
											"username": "Tiffany.Dibbert",
											"email": "Elliott.Runolfsson@yahoo.com",
											"phone": "1-578-998-1626 x882",
											"website": "madalyn.net",
											"amount": "602.45",
											"date": "2012-02-02T06:00:00Z",
											"business": "Price Inc",
											"name": "Personal Loan Account 9924",
											"type": "deposit",
											"account": "61871935"
										},
										{
											"username": "Tiffany.Dibbert",
											"email": "Elliott.Runolfsson@yahoo.com",
											"phone": "1-578-998-1626 x882",
											"website": "madalyn.net",
											"amount": "377.08",
											"date": "2012-02-02T06:00:00Z",
											"business": "Swaniawski - Barton",
											"name": "Investment Account 1002",
											"type": "withdrawal",
											"account": "24221301"
										},
										{
											"username": "Tiffany.Dibbert",
											"email": "Elliott.Runolfsson@yahoo.com",
											"phone": "1-578-998-1626 x882",
											"website": "madalyn.net",
											"amount": "204.44",
											"date": "2012-02-02T06:00:00Z",
											"business": "Hilpert, Carroll and Kutch",
											"name": "Auto Loan Account 2452",
											"type": "withdrawal",
											"account": "15660473"
										},
										{
											"username": "Troy64",
											"email": "Iva.Quigley95@gmail.com",
											"phone": "1-410-428-1737",
											"website": "kaylin.info",
											"amount": "31.19",
											"date": "2012-02-02T06:00:00Z",
											"business": "Kirlin, MacGyver and Bradtke",
											"name": "Auto Loan Account 3893",
											"type": "payment",
											"account": "81492295"
										},
										{
											"username": "Troy64",
											"email": "Iva.Quigley95@gmail.com",
											"phone": "1-410-428-1737",
											"website": "kaylin.info",
											"amount": "820.25",
											"date": "2012-02-02T06:00:00Z",
											"business": "Conroy - Gutmann",
											"name": "Savings Account 6260",
											"type": "payment",
											"account": "18774408"
										},
										{
											"username": "Troy64",
											"email": "Iva.Quigley95@gmail.com",
											"phone": "1-410-428-1737",
											"website": "kaylin.info",
											"amount": "582.19",
											"date": "2012-02-02T06:00:00Z",
											"business": "Schimmel, Schimmel and Lindgren",
											"name": "Auto Loan Account 9826",
											"type": "payment",
											"account": "99842931"
										},
										{
											"username": "Ford_Fadel39",
											"email": "Foster.Wisozk6@gmail.com",
											"phone": "948-848-5504",
											"website": "payton.name",
											"amount": "340.93",
											"date": "2012-02-02T06:00:00Z",
											"business": "Schinner Inc",
											"name": "Checking Account 5055",
											"type": "withdrawal",
											"account": "68363655"
										}
									],
									"schema": {
										"username": "string",
										"email": "string",
										"phone": "string",
										"website": "string",
										"amount": "string",
										"date": "string",
										"business": "string",
										"name": "string",
										"type": "string",
										"account": "string"
									},
									"filter": null
								},
								"aggData": {
									"username": {
										"Ford_Fadel39": 1,
										"Maurice_Sawayn": 3,
										"Tiffany.Dibbert": 3,
										"Troy64": 3
									}
								},
								"isSummary": false,
								"isSql": false
							}
						},
						"source": [
							"from pyspark.sql.functions import explode\n",
							"from pyspark.sql.functions import flatten\n",
							"from pyspark.sql.functions import arrays_zip\n",
							"df_retail_data_flat_explode = df_retail_data_flat.select(\"username\",\"email\",\"phone\",\"website\",explode(df_retail_data_flat.accountHistory)).select(\"username\",\"email\",\"phone\",\"website\",\"col.*\")\n",
							"display(df_retail_data_flat_explode.limit(10))"
						],
						"outputs": [],
						"execution_count": 14
					},
					{
						"cell_type": "code",
						"source": [
							"df_retail_data_flat_explode.count()"
						],
						"outputs": [],
						"execution_count": 15
					},
					{
						"cell_type": "code",
						"source": [
							"from pyspark.sql.functions import unix_timestamp, from_unixtime\n",
							"from pyspark.sql.types import TimestampType\n",
							"df_retail_data_converted = df_retail_data_flat_explode.select(col('username'),col('email'),col('phone'),col('website'),df_retail_data_flat_explode.amount.cast('int').alias('revenue'),col('date').substr(1, 10).alias('date'),col('type'))"
						],
						"outputs": [],
						"execution_count": 16
					},
					{
						"cell_type": "code",
						"metadata": {
							"diagram": {
								"activateDiagramType": 1,
								"chartConfig": {
									"category": "bar",
									"keys": [
										"username"
									],
									"values": [
										"revenue"
									],
									"yLabel": "revenue",
									"xLabel": "username",
									"aggregation": "SUM",
									"aggByBackend": false
								},
								"previewData": {
									"rows": [
										{
											"username": "Maurice_Sawayn",
											"email": "Priscilla_Jones@hotmail.com",
											"phone": "1-928-355-8933",
											"website": "faye.org",
											"revenue": 107,
											"date": "2012-02-02",
											"type": "payment"
										},
										{
											"username": "Maurice_Sawayn",
											"email": "Priscilla_Jones@hotmail.com",
											"phone": "1-928-355-8933",
											"website": "faye.org",
											"revenue": 650,
											"date": "2012-02-02",
											"type": "payment"
										},
										{
											"username": "Maurice_Sawayn",
											"email": "Priscilla_Jones@hotmail.com",
											"phone": "1-928-355-8933",
											"website": "faye.org",
											"revenue": 878,
											"date": "2012-02-02",
											"type": "deposit"
										},
										{
											"username": "Tiffany.Dibbert",
											"email": "Elliott.Runolfsson@yahoo.com",
											"phone": "1-578-998-1626 x882",
											"website": "madalyn.net",
											"revenue": 602,
											"date": "2012-02-02",
											"type": "deposit"
										},
										{
											"username": "Tiffany.Dibbert",
											"email": "Elliott.Runolfsson@yahoo.com",
											"phone": "1-578-998-1626 x882",
											"website": "madalyn.net",
											"revenue": 377,
											"date": "2012-02-02",
											"type": "withdrawal"
										},
										{
											"username": "Tiffany.Dibbert",
											"email": "Elliott.Runolfsson@yahoo.com",
											"phone": "1-578-998-1626 x882",
											"website": "madalyn.net",
											"revenue": 204,
											"date": "2012-02-02",
											"type": "withdrawal"
										},
										{
											"username": "Troy64",
											"email": "Iva.Quigley95@gmail.com",
											"phone": "1-410-428-1737",
											"website": "kaylin.info",
											"revenue": 31,
											"date": "2012-02-02",
											"type": "payment"
										},
										{
											"username": "Troy64",
											"email": "Iva.Quigley95@gmail.com",
											"phone": "1-410-428-1737",
											"website": "kaylin.info",
											"revenue": 820,
											"date": "2012-02-02",
											"type": "payment"
										},
										{
											"username": "Troy64",
											"email": "Iva.Quigley95@gmail.com",
											"phone": "1-410-428-1737",
											"website": "kaylin.info",
											"revenue": 582,
											"date": "2012-02-02",
											"type": "payment"
										},
										{
											"username": "Ford_Fadel39",
											"email": "Foster.Wisozk6@gmail.com",
											"phone": "948-848-5504",
											"website": "payton.name",
											"revenue": 340,
											"date": "2012-02-02",
											"type": "withdrawal"
										}
									],
									"schema": {
										"username": "string",
										"email": "string",
										"phone": "string",
										"website": "string",
										"revenue": "int",
										"date": "string",
										"type": "string"
									},
									"filter": null
								},
								"aggData": {
									"revenue": {
										"Ford_Fadel39": 340,
										"Maurice_Sawayn": 1635,
										"Tiffany.Dibbert": 1183,
										"Troy64": 1433
									}
								},
								"isSummary": false,
								"isSql": false
							}
						},
						"source": [
							"display(df_retail_data_converted.limit(10))"
						],
						"outputs": [],
						"execution_count": 17
					},
					{
						"cell_type": "code",
						"source": [
							"df_retail_data_converted.printSchema()"
						],
						"outputs": [],
						"execution_count": 18
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Write the Dataframe back to a collection in Cosmos DB\n",
							""
						]
					},
					{
						"cell_type": "code",
						"source": [
							"writeConfig = {\n",
							"    \"Endpoint\": \"https://tonio-analytical-store-test-001.documents.azure.com:443/\",\n",
							"    \"Masterkey\": \"Jg56u8htxwccEV2ysk8MmvoAkreIFhfKoQ0iqSeunTtjc2J41VqMEqKBKabv8rHaeVgedc0CdB6nqKLC0mP41A==\",\n",
							"    \"Database\": \"sample-db-001\",\n",
							"    \"Collection\": \"arnaud_test\",\n",
							"    \"Upsert\": \"true\"\n",
							" }\n",
							" \n",
							"df_retail_data_converted.write.format(\"cosmos.oltp\").mode('Append').options(**writeConfig).save()"
						],
						"outputs": [],
						"execution_count": 23
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Copy to a SQL pool"
						]
					},
					{
						"cell_type": "code",
						"source": [
							"%%spark\n",
							"val df = spark.sql(\"SELECT * FROM default.CosmoDBLink\")"
						],
						"outputs": [],
						"execution_count": 24
					},
					{
						"cell_type": "code",
						"source": [
							"%%spark\n",
							"df.write.sqlanalytics(\"contososqlpool.dbo.CosmoDBLink\", Constants.INTERNAL)"
						],
						"outputs": [],
						"execution_count": 25
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/LoadTripData')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "contosospark",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {}
				},
				"metadata": {
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/58f8824d-32b0-4825-9825-02fa6a801546/resourceGroups/Contoso/providers/Microsoft.Synapse/workspaces/contosoanalytics/bigDataPools/contosospark",
						"name": "contosospark",
						"type": "Spark",
						"endpoint": "https://contosoanalytics.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/contosospark",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 3,
						"cores": 8,
						"memory": 56
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"%%pyspark\n",
							"trip_df = spark.read.load('abfss://datasets@contosolake.dfs.core.windows.net/nyctaxismall/Trip.parquet', format='parquet')\n",
							"date_df = spark.read.load('abfss://datasets@contosolake.dfs.core.windows.net/nyctaxismall/dimDate.parquet', format='parquet')\n",
							"date_df.show(10)\n",
							"display(trip_df.take(10))"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 4
					},
					{
						"cell_type": "code",
						"source": [
							"prepped_df = trip_df.select('PassengerCount')\\\n",
							"                    .filter((trip_df.TripDistanceMiles > 0) & (trip_df.PassengerCount > 0))\\\n",
							"                    .groupBy(trip_df.PassengerCount)#\\\n",
							"                    #.orderBy(trip_df.PassengerCount)\n",
							"\n",
							"display(prepped_df)\n",
							"#taxi_df = sampled_taxi_df.select('totalAmount', 'fareAmount', 'tipAmount', 'paymentType', 'rateCodeId', 'passengerCount'\\\n",
							"#                                , 'tripDistance', 'tpepPickupDateTime', 'tpepDropoffDateTime'\\\n",
							"#                                , date_format('tpepPickupDateTime', 'hh').alias('pickupHour')\\\n",
							"#                                , date_format('tpepPickupDateTime', 'EEEE').alias('weekdayString')\\\n",
							"#                                , (unix_timestamp(col('tpepDropoffDateTime')) - unix_timestamp(col('tpepPickupDateTime'))).alias('tripTimeSecs')\\\n",
							"#                                , (when(col('tipAmount') > 0, 1).otherwise(0)).alias('tipped')\n",
							"#                                )\\\n",
							"#%%sql\n",
							"#SELECT  \n",
							"#    PassengerCount, \n",
							"#    SUM(TripDistanceMiles) as SumTripDistance,\n",
							"#    AVG(TripDistanceMiles) as AvgTripDistance\n",
							"#FROM    \n",
							"#    trip_df t\n",
							"#WHERE   \n",
							"#    TripDistanceMiles > 0 AND PassengerCount > 0\n",
							"#GROUP BY \n",
							"#    PassengerCount\n",
							"#ORDER BY \n",
							"#    PassengerCount"
						],
						"outputs": [],
						"execution_count": 51
					},
					{
						"cell_type": "code",
						"source": [
							"trip_df.createOrReplaceTempView('trip_df')\n",
							"date_df.createOrReplaceTempView('date_df')\n",
							""
						],
						"outputs": [],
						"execution_count": 17
					},
					{
						"cell_type": "code",
						"metadata": {
							"outputCollapsed": true
						},
						"source": [
							"%%sql\n",
							"SELECT\n",
							"    *\n",
							"FROM\n",
							"    trip_df"
						],
						"outputs": [],
						"execution_count": 24
					},
					{
						"cell_type": "code",
						"metadata": {
							"outputCollapsed": true
						},
						"source": [
							"%%sql\n",
							"SELECT \n",
							"    count(*), date_df.Date\n",
							"FROM\n",
							"    trip_df, date_df\n",
							"WHERE\n",
							"    TripDistanceMiles > 0 AND TripDistanceMiles <= 100 AND\n",
							"    date_df.DateID = trip_df.DateID\n",
							"GROUP BY \n",
							"    date_df.Date\n",
							"ORDER BY \n",
							"    date_df.Date"
						],
						"outputs": [],
						"execution_count": 20
					},
					{
						"cell_type": "code",
						"source": [
							"%%sql\n",
							"SELECT  \n",
							"    PassengerCount, \n",
							"    SUM(TripDistanceMiles) as SumTripDistance,\n",
							"    AVG(TripDistanceMiles) as AvgTripDistance\n",
							"FROM    \n",
							"    trip_df t\n",
							"WHERE   \n",
							"    TripDistanceMiles > 0 AND PassengerCount > 0\n",
							"GROUP BY \n",
							"    PassengerCount\n",
							"ORDER BY \n",
							"    PassengerCount"
						],
						"outputs": [],
						"execution_count": 47
					},
					{
						"cell_type": "code",
						"source": [
							"%%sql\n",
							"SELECT     \n",
							"--    PassengerCount,\n",
							"    SUM(TripDistanceMiles) AS SumTripDistance,\n",
							"    AVG(TripDistanceMiles) AS AvgTripDistance,\n",
							"FROM\n",
							"    trip_df\n",
							"    -- t, date_df d\n",
							"    --INNER JOIN d ON t.DateID == d.DateID\n",
							"--GROUP BY\n",
							"  --  PassengerCount\n",
							"--ORDER BY    \n",
							"  --  d.Date"
						],
						"outputs": [],
						"execution_count": 21
					},
					{
						"cell_type": "code",
						"source": [
							"%%sql\n",
							"SELECT\n",
							"    VendorId,\n",
							"    PaymentType,\n",
							"    SUM(TripDistance),\n",
							"    SUM(FareAmount),\n",
							"    AVG(FareAmount)\n",
							"FROM\n",
							"    trip_df\n",
							"WHERE\n",
							"    VendorId IN ('CMT','VTS') AND\n",
							"    PassengerCount > 0 AND\n",
							"    TripDistanceMiles > 0 AND TripDistanceMiles <= 100\n",
							"GROUP BY\n",
							"    VendorId,\n",
							"    PaymentType"
						],
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 1')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"metadata": {
					"language_info": {
						"name": "python"
					}
				},
				"cells": []
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 2')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {}
				},
				"metadata": {
					"language_info": {
						"name": "python"
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							""
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 3')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {}
				},
				"metadata": {
					"language_info": {
						"name": "python"
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							"import pandas asdfaw "
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Notebook 4')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {}
				},
				"metadata": {
					"language_info": {
						"name": "python"
					}
				},
				"cells": [
					{
						"cell_type": "code",
						"source": [
							""
						],
						"attachments": null,
						"outputs": [],
						"execution_count": null
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/Predict NYC taxi tips')]",
			"type": "Microsoft.Synapse/workspaces/notebooks",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"nbformat": 4,
				"nbformat_minor": 2,
				"bigDataPool": {
					"referenceName": "contosospark",
					"type": "BigDataPoolReference"
				},
				"sessionProperties": {
					"driverMemory": "28g",
					"driverCores": 4,
					"executorMemory": "28g",
					"executorCores": 4,
					"numExecutors": 2,
					"conf": {}
				},
				"metadata": {
					"kernelspec": {
						"name": "synapse_pyspark",
						"display_name": "Synapse PySpark"
					},
					"language_info": {
						"name": "python"
					},
					"a365ComputeOptions": {
						"id": "/subscriptions/58f8824d-32b0-4825-9825-02fa6a801546/resourceGroups/Contoso/providers/Microsoft.Synapse/workspaces/contosoanalytics/bigDataPools/contosospark",
						"name": "contosospark",
						"type": "Spark",
						"endpoint": "https://contosoanalytics.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/contosospark",
						"auth": {
							"type": "AAD",
							"authResource": "https://dev.azuresynapse.net"
						},
						"sparkVersion": "2.4",
						"nodeCount": 5,
						"cores": 4,
						"memory": 28
					}
				},
				"cells": [
					{
						"cell_type": "markdown",
						"source": [
							"# Predict NYC Taxi Tips using Spark ML and Azure Open Datasets\n",
							"\n",
							"The notebook ingests, visualizes, prepares and then trains a model based on an Open Dataset that tracks NYC Yellow Taxi trips and various attributes around them.\n",
							"The goal is to predict for a given trip whether there will be a trip or not.\n",
							""
						],
						"attachments": null
					},
					{
						"cell_type": "code",
						"source": [
							"import matplotlib.pyplot as plt\n",
							"\n",
							"from pyspark.sql.functions import unix_timestamp\n",
							"\n",
							"from pyspark.sql import SparkSession\n",
							"from pyspark.sql.types import *\n",
							"from pyspark.sql.functions import *\n",
							"\n",
							"from pyspark.ml import Pipeline\n",
							"from pyspark.ml import PipelineModel\n",
							"from pyspark.ml.feature import RFormula\n",
							"from pyspark.ml.feature import OneHotEncoder, StringIndexer, VectorIndexer\n",
							"from pyspark.ml.classification import LogisticRegression\n",
							"from pyspark.mllib.evaluation import BinaryClassificationMetrics\n",
							"from pyspark.ml.evaluation import BinaryClassificationEvaluator"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 1
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Ingest Data¶ \n",
							"\n",
							"Get a sample data of nyc yellow taxi to make it faster/easier to evaluate different approaches to prep for the modelling phase later in the notebook."
						],
						"attachments": null
					},
					{
						"cell_type": "code",
						"source": [
							"# Import NYC yellow cab data from Azure Open Datasets\n",
							"from azureml.opendatasets import NycTlcYellow\n",
							"\n",
							"from datetime import datetime\n",
							"from dateutil import parser\n",
							"\n",
							"end_date = parser.parse('2018-05-08 00:00:00')\n",
							"start_date = parser.parse('2018-05-01 00:00:00')\n",
							"\n",
							"nyc_tlc = NycTlcYellow(start_date=start_date, end_date=end_date)\n",
							"nyc_tlc_df = nyc_tlc.to_spark_dataframe()"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 2
					},
					{
						"cell_type": "code",
						"source": [
							"#To make development easier, faster and less expensive downsample for now\n",
							"sampled_taxi_df = nyc_tlc_df.sample(True, 0.001, seed=1234)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 3
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Exploratory Data Analysis\n",
							"\n",
							"Look at the data and evaluate its suitability for use in a model, do this via some basic charts focussed on tip values and relationships."
						],
						"attachments": null
					},
					{
						"cell_type": "code",
						"source": [
							"#The charting package needs a Pandas dataframe or numpy array do the conversion\n",
							"sampled_taxi_pd_df = sampled_taxi_df.toPandas()\n",
							"\n",
							"# Look at tips by amount count histogram\n",
							"ax1 = sampled_taxi_pd_df['tipAmount'].plot(kind='hist', bins=25, facecolor='lightblue')\n",
							"ax1.set_title('Tip amount distribution')\n",
							"ax1.set_xlabel('Tip Amount ($)')\n",
							"ax1.set_ylabel('Counts')\n",
							"plt.suptitle('')\n",
							"plt.show()\n",
							"\n",
							"# How many passengers tip'd by various amounts\n",
							"ax2 = sampled_taxi_pd_df.boxplot(column=['tipAmount'], by=['passengerCount'])\n",
							"ax2.set_title('Tip amount by Passenger count')\n",
							"ax2.set_xlabel('Passenger count') \n",
							"ax2.set_ylabel('Tip Amount ($)')\n",
							"plt.suptitle('')\n",
							"plt.show()\n",
							"\n",
							"# Look at the relationship between fare and tip amounts\n",
							"ax = sampled_taxi_pd_df.plot(kind='scatter', x= 'fareAmount', y = 'tipAmount', c='blue', alpha = 0.10, s=2.5*(sampled_taxi_pd_df['passengerCount']))\n",
							"ax.set_title('Tip amount by Fare amount')\n",
							"ax.set_xlabel('Fare Amount ($)')\n",
							"ax.set_ylabel('Tip Amount ($)')\n",
							"plt.axis([-2, 80, -2, 20])\n",
							"plt.suptitle('')\n",
							"plt.show()"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 4
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Data Prep and Featurization\n",
							"\n",
							"It's clear from the visualizations above that there are a bunch of outliers in the data. These will need to be filtered out in addition there are extra variables that are not going to be useful in the model we build at the end.\n",
							"\n",
							"Finally there is a need to create some new (derived) variables that will work better with the model.\n",
							""
						],
						"attachments": null
					},
					{
						"cell_type": "code",
						"source": [
							"taxi_df = sampled_taxi_df.select('totalAmount', 'fareAmount', 'tipAmount', 'paymentType', 'rateCodeId', 'passengerCount'\\\n",
							"                                , 'tripDistance', 'tpepPickupDateTime', 'tpepDropoffDateTime'\\\n",
							"                                , date_format('tpepPickupDateTime', 'hh').alias('pickupHour')\\\n",
							"                                , date_format('tpepPickupDateTime', 'EEEE').alias('weekdayString')\\\n",
							"                                , (unix_timestamp(col('tpepDropoffDateTime')) - unix_timestamp(col('tpepPickupDateTime'))).alias('tripTimeSecs')\\\n",
							"                                , (when(col('tipAmount') > 0, 1).otherwise(0)).alias('tipped')\n",
							"                                )\\\n",
							"                        .filter((sampled_taxi_df.passengerCount > 0) & (sampled_taxi_df.passengerCount < 8)\\\n",
							"                                & (sampled_taxi_df.tipAmount >= 0) & (sampled_taxi_df.tipAmount <= 25)\\\n",
							"                                & (sampled_taxi_df.fareAmount >= 1) & (sampled_taxi_df.fareAmount <= 250)\\\n",
							"                                & (sampled_taxi_df.tipAmount < sampled_taxi_df.fareAmount)\\\n",
							"                                & (sampled_taxi_df.tripDistance > 0) & (sampled_taxi_df.tripDistance <= 100)\\\n",
							"                                & (sampled_taxi_df.rateCodeId <= 5)\n",
							"                                & (sampled_taxi_df.paymentType.isin({\"1\", \"2\"}))\n",
							"                                )"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 5
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Data Prep and Featurization Part 2\n",
							"\n",
							"Having created new variables its now possible to drop the columns they were derived from so that the dataframe that goes into the model is the smallest in terms of number of variables, that is required.\n",
							"\n",
							"Also create some more features based on new columns from the first round.\n",
							""
						],
						"attachments": null
					},
					{
						"cell_type": "code",
						"source": [
							"taxi_featurised_df = taxi_df.select('totalAmount', 'fareAmount', 'tipAmount', 'paymentType', 'passengerCount'\\\n",
							"                                                , 'tripDistance', 'weekdayString', 'pickupHour','tripTimeSecs','tipped'\\\n",
							"                                                , when((taxi_df.pickupHour <= 6) | (taxi_df.pickupHour >= 20),\"Night\")\\\n",
							"                                                .when((taxi_df.pickupHour >= 7) & (taxi_df.pickupHour <= 10), \"AMRush\")\\\n",
							"                                                .when((taxi_df.pickupHour >= 11) & (taxi_df.pickupHour <= 15), \"Afternoon\")\\\n",
							"                                                .when((taxi_df.pickupHour >= 16) & (taxi_df.pickupHour <= 19), \"PMRush\")\\\n",
							"                                                .otherwise(0).alias('trafficTimeBins')\n",
							"                                              )\\\n",
							"                                       .filter((taxi_df.tripTimeSecs >= 30) & (taxi_df.tripTimeSecs <= 7200))"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 6
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Encoding\n",
							"\n",
							"Different ML algorithms support different types of input, for this example Logistic Regression is being used for Binary Classification. This means that any Categorical (string) variables must be converted to numbers.\n",
							"\n",
							"The process is not as simple as a \"map\" style function as the relationship between the numbers can introduce a bias in the resulting model, the approach is to index the variable and then encode using a std approach called One Hot Encoding.\n",
							"\n",
							"This approach requires the encoder to \"learn\"/fit a model over the data in the Spark instance and then transform based on what was learnt.\n",
							""
						],
						"attachments": null
					},
					{
						"cell_type": "code",
						"source": [
							"# The sample uses an algorithm that only works with numeric features convert them so they can be consumed\n",
							"sI1 = StringIndexer(inputCol=\"trafficTimeBins\", outputCol=\"trafficTimeBinsIndex\"); \n",
							"en1 = OneHotEncoder(dropLast=False, inputCol=\"trafficTimeBinsIndex\", outputCol=\"trafficTimeBinsVec\");\n",
							"sI2 = StringIndexer(inputCol=\"weekdayString\", outputCol=\"weekdayIndex\"); \n",
							"en2 = OneHotEncoder(dropLast=False, inputCol=\"weekdayIndex\", outputCol=\"weekdayVec\");\n",
							"\n",
							"# Create a new dataframe that has had the encodings applied\n",
							"encoded_final_df = Pipeline(stages=[sI1, en1, sI2, en2]).fit(taxi_featurised_df).transform(taxi_featurised_df)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 7
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Generation of Testing and Training Data Sets\n",
							"Simple split, 70% for training and 30% for testing the model. Playing with this ratio may result in different models.\n",
							""
						],
						"attachments": null
					},
					{
						"cell_type": "code",
						"source": [
							"# Decide on the split between training and testing data from the dataframe \n",
							"trainingFraction = 0.7\n",
							"testingFraction = (1-trainingFraction)\n",
							"seed = 1234\n",
							"\n",
							"# Split the dataframe into test and training dataframes\n",
							"train_data_df, test_data_df = encoded_final_df.randomSplit([trainingFraction, testingFraction], seed=seed)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 8
					},
					{
						"cell_type": "markdown",
						"source": [
							"## Train the Model\n",
							"\n",
							"Train the Logistic Regression model and then evaluate it using Area under Receiver Operating Characteristic curve as the metric."
						],
						"attachments": null
					},
					{
						"cell_type": "code",
						"source": [
							"## Create a new LR object for the model\n",
							"logReg = LogisticRegression(maxIter=10, regParam=0.3, labelCol = 'tipped')\n",
							"\n",
							"## The formula for the model\n",
							"classFormula = RFormula(formula=\"tipped ~ pickupHour + weekdayVec + passengerCount + tripTimeSecs + tripDistance + fareAmount + paymentType+ trafficTimeBinsVec\")\n",
							"\n",
							"## Undertake training and create an LR model\n",
							"lrModel = Pipeline(stages=[classFormula, logReg]).fit(train_data_df)\n",
							"\n",
							"## Saving the model is optional but its another for of inter session cache\n",
							"datestamp = datetime.now().strftime('%m-%d-%Y-%s');\n",
							"fileName = \"lrModel_\" + datestamp;\n",
							"logRegDirfilename = fileName;\n",
							"lrModel.save(logRegDirfilename)\n",
							"\n",
							"## Predict tip 1/0 (yes/no) on the test dataset, evaluation using AUROC\n",
							"predictions = lrModel.transform(test_data_df)\n",
							"predictionAndLabels = predictions.select(\"label\",\"prediction\").rdd\n",
							"metrics = BinaryClassificationMetrics(predictionAndLabels)\n",
							"print(\"Area under ReceiverOperatingCharacteristicCurve = %s\" % metrics.areaUnderReceiverOperatingCharacteristicCurve)"
						],
						"attachments": null,
						"outputs": [],
						"execution_count": 9
					}
				]
			},
			"dependsOn": []
		},
		{
			"name": "[concat(parameters('workspaceName'), '/SQL script 4')]",
			"type": "Microsoft.Synapse/workspaces/sqlscripts",
			"apiVersion": "2019-06-01-preview",
			"properties": {
				"content": {
					"query": "",
					"metadata": {
						"language": "sql"
					},
					"currentConnection": {
						"name": "master",
						"type": "SqlOnDemand"
					}
				},
				"type": "SqlQuery"
			},
			"dependsOn": []
		}
	]
}